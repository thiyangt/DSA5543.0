% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  11pt,
  a4paper,
]{report}

\usepackage{amsmath,amssymb}
\usepackage{setspace}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[top=2.5cm,bottom=2.5cm,left=2.5cm,right=2.5cm]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{2}

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage[style=authoryear-comp,]{biblatex}
\addbibresource{thesisrefs.bib}
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={DSA 554 3.0 Spatio-temporal Data Analysis},
  pdfauthor={Thiyanga S. Talagala},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

%% CAPTIONS
\usepackage{caption}
\DeclareCaptionStyle{italic}[justification=centering]
 {labelfont={bf},textfont={it},labelsep=colon}
\captionsetup[figure]{style=italic,format=hang,singlelinecheck=true}
\captionsetup[table]{style=italic,format=hang,singlelinecheck=true}

%% FONT
\usepackage{bera}
\usepackage[charter]{mathdesign}
%\usepackage[scale=0.9]{sourcecodepro}
\usepackage[lf,t]{FiraSans}
\usepackage{fontawesome}

%% HEADERS AND FOOTERS
\usepackage{fancyhdr}
\pagestyle{fancy}
\rfoot{\Large\sffamily\raisebox{-0.1cm}{\textbf{\thepage}}}
\makeatletter
\lhead{\textsf{\expandafter{\@title}}}
\makeatother
\rhead{}
\cfoot{}
\setlength{\headheight}{15pt}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\fancypagestyle{plain}{%
\fancyhf{} % clear all header and footer fields
\fancyfoot[C]{\sffamily\thepage} % except the center
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}}

%% MATHS
\usepackage{bm,amsmath}
\allowdisplaybreaks

%% GRAPHICS
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setcounter{topnumber}{2}
\setcounter{bottomnumber}{2}
\setcounter{totalnumber}{4}
\renewcommand{\topfraction}{0.85}
\renewcommand{\bottomfraction}{0.85}
\renewcommand{\textfraction}{0.15}
\renewcommand{\floatpagefraction}{0.8}
\graphicspath{{figures/}}

%% SECTION TITLES
\usepackage[compact,sf,bf]{titlesec}
\titleformat*{\section}{\Large\sf\bfseries}
\titleformat*{\subsection}{\large\sf\bfseries}
\titleformat*{\subsubsection}{\sf\bfseries}
\titlespacing{\section}{0pt}{*5}{*1}
\titlespacing{\subsection}{0pt}{*2}{*0.2}
\titlespacing{\subsubsection}{0pt}{*1}{*0.1}

%% TABLES
\usepackage{booktabs,tabu}

%% BIBLIOGRAPHY.

\makeatletter
\@ifpackageloaded{biblatex}{
\ExecuteBibliographyOptions{bibencoding=utf8,minnames=1,maxnames=3, maxbibnames=99,dashed=false,terseinits=true,giveninits=true,uniquename=false,uniquelist=false,doi=false, isbn=false,url=true,sortcites=false}
\DeclareFieldFormat{url}{\texttt{\url{#1}}}
\DeclareFieldFormat[article]{pages}{#1}
\DeclareFieldFormat[inproceedings]{pages}{\lowercase{pp.}#1}
\DeclareFieldFormat[incollection]{pages}{\lowercase{pp.}#1}
\DeclareFieldFormat[article]{volume}{\mkbibbold{#1}}
\DeclareFieldFormat[article]{number}{\mkbibparens{#1}}
\DeclareFieldFormat[article]{title}{\MakeCapital{#1}}
\DeclareFieldFormat[article]{url}{}
\DeclareFieldFormat[inproceedings]{title}{#1}
\DeclareFieldFormat{shorthandwidth}{#1}
\usepackage{xpatch}
\xpatchbibmacro{volume+number+eid}{\setunit*{\adddot}}{}{}{}
% Remove In: for an article.
\renewbibmacro{in:}{%
  \ifentrytype{article}{}{%
  \printtext{\bibstring{in}\intitlepunct}}}
\AtEveryBibitem{\clearfield{month}}
\AtEveryCitekey{\clearfield{month}}
\DeclareDelimFormat[cbx@textcite]{nameyeardelim}{\addspace}
\renewcommand*{\finalnamedelim}{\addspace\&\space}
}{}
\makeatother


\hypersetup{
     pdfcreator={Quarto -> pandoc -> LaTeX -> pdf}
}


%% PAGE BREAKING to avoid widows and orphans
\clubpenalty = 2000
\widowpenalty = 2000
\usepackage{microtype}
\def\maketitle{
\pagenumbering{roman}
{\sf\thispagestyle{empty}%
  \null\vskip-.4cm%
  \centerline{\includegraphics[width=12cm]{monash-logo}}
  \vspace*{4cm}
  \begin{center}\fontsize{24}{28}\sf
     \textbf{DSA 554 3.0 Spatio-temporal Data Analysis}\\[2cm]
     \fontsize{18}{20}\sf Thiyanga S. Talagala\\[0.2cm]
     \fontsize{13}{15}\sf 
     \vfill
     \fontsize{13}{15}\sf A thesis submitted for the degree of\\ \\ at Monash University in \number\the\year\\
     
  \end{center}
  \newpage\mbox{}\thispagestyle{empty}\newpage
}
}

% Title and date

\title{DSA 554 3.0 Spatio-temporal Data Analysis}
\date{}
\begin{document}
\maketitle

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{1}
\tableofcontents
}

\setstretch{1.5}
\bookmarksetup{startatroot}

\chapter*{Copyright notice}\label{copyright-notice}
\addcontentsline{toc}{chapter}{Copyright notice}

\markboth{Copyright notice}{Copyright notice}

Produced on 22 November 2025.

¬© Thiyanga S. Talagala (2025).

\clearpage\pagenumbering{arabic}\setcounter{page}{1}

\bookmarksetup{startatroot}

\chapter{Introduction}\label{sec-intro}

In statistics and data science, datasets can take different forms
depending on how they are collected and organized. Understanding the
type of data is crucial because it guides the choice of appropriate
analytical methods.

\section{Cross-sectional data}\label{cross-sectional-data}

Data collected at a single point in time across multiple units (e.g.,
households, firms, individuals).

\textbf{Example:} household income survey conducted in 2025.

\textbf{Assumption:} Each observation (e.g., each household, individual,
firm) is assumed to be unrelated to the others.

In practice, this assumption can be violated if:

\begin{itemize}
\item
  There's clustering (e.g., individuals from the same village may be
  correlated).
\item
  There's spatial correlation (e.g., nearby locations may be similar).
\item
  There's hidden time effects (if data were not truly collected at the
  same time).
\end{itemize}

\section{Time series data}\label{time-series-data}

A time series is a sequence of observations taken sequentially in time.
The data may consist of one variable (univariate time series) or
multiple variables (multivariate time series) observed over regular or
irregular time intervals.

\textbf{Examples:}

Univariate: Monthly rainfall in Colombo from 2000--2025.

Multivariate: Monthly rainfall, temperature, and humidity in Colombo
from 2000--2025.

\section{Spatial data}\label{spatial-data}

Data linked to a geographical location or space.

Example: soil pH levels measured across different districts in Sri
Lanka.

\section{Spatio-temporal data}\label{spatio-temporal-data}

Data that varies across both space and time.

Example: daily dengue cases recorded across different districts over
several years.

\section{Longitudinal data (Repeated
cross-sections)}\label{longitudinal-data-repeated-cross-sections}

Longitudinal data refer to data collected through repeated measurements
over time. The measurements may be taken on the same units (e.g.,
following the same households each year) or on different units at
different time points (e.g., different random samples of households each
year).

\textbf{Example (different random samples of households each year)}

Suppose a national health survey is conducted every 5 years (2000, 2005,
2010, 2015, 2020). Each time, a new random sample of 5,000 households is
selected.

In 2000 ‚Üí Households A, B, C, \ldots{}

In 2005 ‚Üí Households X, Y, Z, \ldots{}

In 2010 ‚Üí Households P, Q, R, \ldots{}

Here, the same households are not followed across time, but the survey
is still longitudinal, since measurements are taken repeatedly over time
to study population-level changes (e.g., trends in obesity, smoking
rates, or income inequality).

\section{Panel data}\label{panel-data}

Panel data are a special case of longitudinal data, where the same units
are observed consistently across multiple time periods. This allows
analysts to study both within-unit dynamics (how a given unit changes
over time) and between-unit differences.

In finance and econometric modelling, panel data is widely used because
it captures both the cross-sectional dimension (different firms,
individuals, or markets) and the time dimension (repeated observations).

In Panel data and Longitudinal data, which combines cross-sectional and
time-series data, allows for the examination of both ``within-behavior''
and ``between-behavior'' effects.

\textbf{Example (Country-level Panel Data)}

Suppose you collect data on GDP growth rates for 50 countries from
2000--2020.

\textbf{1. Country-specific behavior (within a country over time)}

You can see how Sri Lanka's GDP growth changed year by year.

Example:

\begin{itemize}
\tightlist
\item
  was there a slowdown after the 2008 global crisis, followed by
  recovery?
\end{itemize}

\textbf{2. cross-country and temporal effects (Between countries over
time)}

You can compare trends across countries.

Example:

\begin{itemize}
\item
  Did most countries experience a dip in 2008--2009 due to the financial
  crisis?
\item
  Do developing countries generally grow faster than developed countries
  over these 20 years?
\end{itemize}

\bookmarksetup{startatroot}

\chapter{Introduction to Time Series
Analysis}\label{introduction-to-time-series-analysis}

\section{Time series}\label{time-series}

A time series is a sequence of observations recorded in time order. The
time intervals between observations can be regular (e.g., daily,
monthly, yearly) or irregular (e.g., magnitude of a earthquake at a
particular location).

\section{Main Time Series Patterns}\label{main-time-series-patterns}

\subsection{Trend}\label{trend}

Long-term increase or decrease in the data.

\subsection{Seasonal}\label{seasonal}

\begin{itemize}
\item
  A seasonal pattern exists when a series is influenced by seasonal
  factors (e.g., the quarter of the year, the month, or day of the
  week).
\item
  Seasonality is always of a fixed and known period.
\end{itemize}

\subsection{Cyclic}\label{cyclic}

\begin{itemize}
\item
  A cyclic pattern exists when data exhibit rises and falls that are not
  of fixed period.
\item
  The duration of these fluctuations is usually of at least 2 years.
\item
  The average length of cycles is longer than the length of a seasonal
  pattern.
\end{itemize}

\section{Frequency of a time series (Seasonal
periods)}\label{frequency-of-a-time-series-seasonal-periods}

Number of observations per natural time interval (Usually year, but
sometimes a week, a day, an hour)

\subsection{Single Seasonality}\label{single-seasonality}

The time series exhibits one repeating pattern at a fixed frequency.

Example:

Monthly sales that peak every December (annual seasonality).

\begin{longtable}[]{@{}lr@{}}
\toprule\noalign{}
Data & Frequency \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Annual & 1 \\
Quarterly & 4 \\
Monthly & 12 \\
Weekly & 52 \\
\end{longtable}

\subsection{Multiple Seasonality}\label{multiple-seasonality}

The time series exhibits more than one repeating pattern at different
frequencies simultaneously.

Example:

Hourly electricity demand with a daily pattern (peaks every day at
certain hours), a weekly pattern (weekdays vs weekends).

Website traffic with hourly variation and seasonal holiday peaks.

\begin{longtable}[]{@{}cccccc@{}}
\caption{Time Unit Frequencies}\tabularnewline
\toprule\noalign{}
Data & Minute & Hour & Day & Week & Year \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
Data & Minute & Hour & Day & Week & Year \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Daily & NA & NA & NA & 7 & 365.25 \\
Hourly & NA & NA & 24 & 168 & 8766.00 \\
Half-hourly & NA & NA & 48 & 336 & 17532.00 \\
Minutes & 60 & 1440 & 1440 & 10080 & 525960.00 \\
Seconds & 60 & 3600 & 86400 & 604800 & 31557600.00 \\
\end{longtable}

\section{\texorpdfstring{\texttt{DataFrame} for time series data:
Python}{DataFrame for time series data: Python}}\label{dataframe-for-time-series-data-python}

When your DataFrame represents a time series, the index is usually the
date or time, allowing pandas to:

\begin{itemize}
\item
  Plot time series easily
\item
  Resample or aggregate data by time
\item
  Compute rolling statistics
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Import pandas}
\CommentTok{\#py {-}m pip install pandas}
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}

\CommentTok{\# Define data}
\NormalTok{value }\OperatorTok{=}\NormalTok{ [}\DecValTok{100}\NormalTok{, }\DecValTok{250}\NormalTok{, }\DecValTok{78}\NormalTok{, }\DecValTok{300}\NormalTok{, }\DecValTok{500}\NormalTok{]}
\NormalTok{time }\OperatorTok{=} \BuiltInTok{list}\NormalTok{(}\BuiltInTok{range}\NormalTok{(}\DecValTok{2015}\NormalTok{, }\DecValTok{2020}\NormalTok{))}

\CommentTok{\# Create DataFrame}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{"Year"}\NormalTok{: time, }\StringTok{"Observation"}\NormalTok{: value\})}

\CommentTok{\# Set \textquotesingle{}Year\textquotesingle{} as index}
\NormalTok{df.set\_index(}\StringTok{"Year"}\NormalTok{, inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}

\CommentTok{\# Display the DataFrame}
\BuiltInTok{print}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      Observation
Year             
2015          100
2016          250
2017           78
2018          300
2019          500
\end{verbatim}

For data collected more often than once a year (e.g., monthly, weekly,
or daily), it's important to tell the computer that the index represents
time. We do this by converting the index to a time or date type using a
time-class function. This helps us sort, select, and analyze the data
correctly over time.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Sample monthly data}
\NormalTok{data }\OperatorTok{=}\NormalTok{ \{}
    \StringTok{"Month"}\NormalTok{: pd.date\_range(start}\OperatorTok{=}\StringTok{"2025{-}01{-}01"}\NormalTok{, periods}\OperatorTok{=}\DecValTok{6}\NormalTok{, freq}\OperatorTok{=}\StringTok{"M"}\NormalTok{),  }\CommentTok{\# 6 months}
    \StringTok{"Sales"}\NormalTok{: [}\DecValTok{120}\NormalTok{, }\DecValTok{150}\NormalTok{, }\DecValTok{170}\NormalTok{, }\DecValTok{130}\NormalTok{, }\DecValTok{180}\NormalTok{, }\DecValTok{200}\NormalTok{]}
\NormalTok{\}}

\CommentTok{\# Create DataFrame}
\NormalTok{z }\OperatorTok{=}\NormalTok{ pd.DataFrame(data)}

\CommentTok{\# Format Month as "Year Month" (e.g., "2025 Jan")}
\NormalTok{z[}\StringTok{"Month"}\NormalTok{] }\OperatorTok{=}\NormalTok{ z[}\StringTok{"Month"}\NormalTok{].dt.strftime(}\StringTok{"\%Y \%b"}\NormalTok{)}

\CommentTok{\# Set Month as index}
\NormalTok{z.set\_index(}\StringTok{"Month"}\NormalTok{, inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}

\CommentTok{\# Display the DataFrame}
\BuiltInTok{print}\NormalTok{(z)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          Sales
Month          
2025 Jan    120
2025 Feb    150
2025 Mar    170
2025 Apr    130
2025 May    180
2025 Jun    200
\end{verbatim}

\section{\texorpdfstring{\texttt{DataFrame} for time series data:
R}{DataFrame for time series data: R}}\label{dataframe-for-time-series-data-r}

We use tsibbles to store data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(tsibble)}
\FunctionTok{library}\NormalTok{(lubridate)}
\FunctionTok{library}\NormalTok{(feasts)}
\FunctionTok{library}\NormalTok{(denguedatahub)}
\CommentTok{\# install.packages("devtools")}
\CommentTok{\#devtools::install\_github("thiyangt/TourSriLanka")}
\FunctionTok{library}\NormalTok{(TourSriLanka)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y.tsibble }\OtherTok{\textless{}{-}} \FunctionTok{tsibble}\NormalTok{(}
  \AttributeTok{Year =} \DecValTok{2020}\SpecialCharTok{:}\DecValTok{2023}\NormalTok{,}
  \AttributeTok{Earnings =} \FunctionTok{c}\NormalTok{(}\FloatTok{682.4}\NormalTok{, }\FloatTok{506.9}\NormalTok{, }\FloatTok{1136.3}\NormalTok{, }\FloatTok{2068.0}\NormalTok{),}
  \AttributeTok{index =}\NormalTok{ Year)}
\NormalTok{y.tsibble}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tsibble: 4 x 2 [1Y]
   Year Earnings
  <int>    <dbl>
1  2020     682.
2  2021     507.
3  2022    1136.
4  2023    2068 
\end{verbatim}

\section{Dataset: R}\label{dataset-r}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(TourSriLanka)}
\FunctionTok{data}\NormalTok{(earnings)}
\NormalTok{earnings}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 180 x 3
   Month   Year  Earnings
   <chr>   <chr>    <dbl>
 1 January 2009      30  
 2 January 2010      44.7
 3 January 2011      72  
 4 January 2012      88.9
 5 January 2013     149. 
 6 January 2014     233. 
 7 January 2015     259  
 8 January 2016     333. 
 9 January 2017     407. 
10 January 2018     448. 
# i 170 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{earnings }\OtherTok{\textless{}{-}}\NormalTok{ earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(Year, }\FunctionTok{match}\NormalTok{(Month, month.name) )}
\NormalTok{earnings}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 180 x 3
   Month     Year  Earnings
   <chr>     <chr>    <dbl>
 1 January   2009      30  
 2 February  2009      26.7
 3 March     2009      26.6
 4 April     2009      20.3
 5 May       2009      19.3
 6 June      2009      23.6
 7 July      2009      33  
 8 August    2009      32.2
 9 September 2009      29.6
10 October   2009      29.3
# i 170 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y.earnings }\OtherTok{\textless{}{-}}\NormalTok{ earnings }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Date =} \FunctionTok{seq}\NormalTok{(}\FunctionTok{ymd\_hm}\NormalTok{(}\StringTok{"2009{-}1{-}1 0:00"}\NormalTok{), }\FunctionTok{ymd\_hm}\NormalTok{(}\StringTok{"2023{-}12{-}1 12:00"}\NormalTok{), }\AttributeTok{by =} \StringTok{"month"}\NormalTok{))}
\NormalTok{y.earnings}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 180 x 4
   Month     Year  Earnings Date               
   <chr>     <chr>    <dbl> <dttm>             
 1 January   2009      30   2009-01-01 00:00:00
 2 February  2009      26.7 2009-02-01 00:00:00
 3 March     2009      26.6 2009-03-01 00:00:00
 4 April     2009      20.3 2009-04-01 00:00:00
 5 May       2009      19.3 2009-05-01 00:00:00
 6 June      2009      23.6 2009-06-01 00:00:00
 7 July      2009      33   2009-07-01 00:00:00
 8 August    2009      32.2 2009-08-01 00:00:00
 9 September 2009      29.6 2009-09-01 00:00:00
10 October   2009      29.3 2009-10-01 00:00:00
# i 170 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y.earnings }\OtherTok{\textless{}{-}}\NormalTok{ y.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{select}\NormalTok{(Earnings, Date) }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Time =} \FunctionTok{yearmonth}\NormalTok{(Date))}
\NormalTok{y.earnings}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 180 x 3
   Earnings Date                    Time
      <dbl> <dttm>                 <mth>
 1     30   2009-01-01 00:00:00 2009 Jan
 2     26.7 2009-02-01 00:00:00 2009 Feb
 3     26.6 2009-03-01 00:00:00 2009 Mar
 4     20.3 2009-04-01 00:00:00 2009 Apr
 5     19.3 2009-05-01 00:00:00 2009 May
 6     23.6 2009-06-01 00:00:00 2009 Jun
 7     33   2009-07-01 00:00:00 2009 Jul
 8     32.2 2009-08-01 00:00:00 2009 Aug
 9     29.6 2009-09-01 00:00:00 2009 Sep
10     29.3 2009-10-01 00:00:00 2009 Oct
# i 170 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ts.earnings }\OtherTok{\textless{}{-}}\NormalTok{ y.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{select}\NormalTok{(Earnings, Time) }\SpecialCharTok{|\textgreater{}} \FunctionTok{as\_tsibble}\NormalTok{(}\AttributeTok{index=}\NormalTok{Time)}
\NormalTok{ts.earnings}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tsibble: 180 x 2 [1M]
   Earnings     Time
      <dbl>    <mth>
 1     30   2009 Jan
 2     26.7 2009 Feb
 3     26.6 2009 Mar
 4     20.3 2009 Apr
 5     19.3 2009 May
 6     23.6 2009 Jun
 7     33   2009 Jul
 8     32.2 2009 Aug
 9     29.6 2009 Sep
10     29.3 2009 Oct
# i 170 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggts }\OtherTok{\textless{}{-}}\NormalTok{ ts.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Time, }\AttributeTok{y =}\NormalTok{ Earnings)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Earnings from tourism (USD Mn)"}\NormalTok{, }\AttributeTok{x=}\StringTok{"Time"}\NormalTok{)  }
\NormalTok{ggts}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-13-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ts.earnings }\OtherTok{\textless{}{-}}\NormalTok{ y.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{select}\NormalTok{(Earnings, Time) }\SpecialCharTok{|\textgreater{}} \FunctionTok{as\_tsibble}\NormalTok{(}\AttributeTok{index=}\NormalTok{Time)}
\NormalTok{ts.earnings}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tsibble: 180 x 2 [1M]
   Earnings     Time
      <dbl>    <mth>
 1     30   2009 Jan
 2     26.7 2009 Feb
 3     26.6 2009 Mar
 4     20.3 2009 Apr
 5     19.3 2009 May
 6     23.6 2009 Jun
 7     33   2009 Jul
 8     32.2 2009 Aug
 9     29.6 2009 Sep
10     29.3 2009 Oct
# i 170 more rows
\end{verbatim}

\section{Time series visualisation using grammar of graphics:
R}\label{time-series-visualisation-using-grammar-of-graphics-r}

The grammar of graphics is a way of thinking about plots as layers. Each
plot is built from components like:

\textbf{Data} -- the dataset you are plotting.

\textbf{Aesthetics (aes)} -- how variables map to visual properties like
x, y, color, or size.

\textbf{Geometries (geom)} -- the type of plot (points, lines, bars,
etc.).

\textbf{Facets} -- split the plot into subplots based on a variable.

\textbf{Statistics (stat)} -- summary computations like regression lines
or counts.

\textbf{Scales} -- control axis limits, colors, or sizes.

\textbf{Coordinates (coord)} -- control coordinate system (Cartesian,
polar).

\textbf{Theme} -- control visual appearance like text, background, and
grid.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggts }\OtherTok{\textless{}{-}}\NormalTok{ ts.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Time, }\AttributeTok{y =}\NormalTok{ Earnings)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Earnings from tourism (USD Mn)"}\NormalTok{, }\AttributeTok{x=}\StringTok{"Time"}\NormalTok{)  }
\NormalTok{ggts}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-15-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ggts }\OtherTok{\textless{}{-}}\NormalTok{ ts.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Time, }\AttributeTok{y =}\NormalTok{ Earnings)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Earnings from tourism (USD Mn)"}\NormalTok{, }\AttributeTok{x=}\StringTok{"Time"}\NormalTok{)  }
\NormalTok{ggts}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-16-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ts.earnings }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Time =} \FunctionTok{as\_date}\NormalTok{(}\FunctionTok{yearmonth}\NormalTok{(Time))) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Time, }\AttributeTok{y =}\NormalTok{ Earnings)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 year"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%Y"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Earnings from tourism (USD Mn)"}\NormalTok{, }\AttributeTok{x=}\StringTok{"Time"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-17-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(viridis)}
\NormalTok{ts.earnings }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{gg\_season}\NormalTok{(Earnings, }\AttributeTok{period =} \StringTok{"1 year"}\NormalTok{,  }\AttributeTok{pal =}\NormalTok{ scales}\SpecialCharTok{::}\FunctionTok{viridis\_pal}\NormalTok{()(}\DecValTok{15}\NormalTok{))  }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()  }
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-18-1.pdf}}

\section{Dataset: Python}\label{dataset-python}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ plotnine }\ImportTok{as}\NormalTok{ p9}
\ImportTok{from}\NormalTok{ plotnine.data }\ImportTok{import}\NormalTok{ economics}
\end{Highlighting}
\end{Shaded}

\section{Working with Built-in Data
Set}\label{working-with-built-in-data-set}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ plotnine }\ImportTok{as}\NormalTok{ p9 }
\ImportTok{from}\NormalTok{ plotnine }\ImportTok{import} \OperatorTok{*}
\ImportTok{from}\NormalTok{ plotnine.data }\ImportTok{import} \OperatorTok{*}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{economics}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          date      pce     pop  psavert  uempmed  unemploy
0   1967-07-01    507.4  198712     12.5      4.5      2944
1   1967-08-01    510.5  198911     12.5      4.7      2945
2   1967-09-01    516.3  199113     11.7      4.6      2958
3   1967-10-01    512.9  199311     12.5      4.9      3143
4   1967-11-01    518.1  199498     12.5      4.7      3066
..         ...      ...     ...      ...      ...       ...
569 2014-12-01  12122.0  320201      5.0     12.6      8688
570 2015-01-01  12080.8  320367      5.5     13.4      8979
571 2015-02-01  12095.9  320534      5.7     13.1      8705
572 2015-03-01  12161.5  320707      5.2     12.2      8575
573 2015-04-01  12158.9  320887      5.6     11.7      8549

[574 rows x 6 columns]
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{economics.info()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 574 entries, 0 to 573
Data columns (total 6 columns):
 #   Column    Non-Null Count  Dtype         
---  ------    --------------  -----         
 0   date      574 non-null    datetime64[ns]
 1   pce       574 non-null    float64       
 2   pop       574 non-null    int64         
 3   psavert   574 non-null    float64       
 4   uempmed   574 non-null    float64       
 5   unemploy  574 non-null    int64         
dtypes: datetime64[ns](1), float64(3), int64(2)
memory usage: 27.0 KB
\end{verbatim}

\subsection{\texorpdfstring{Create \texttt{year} and \texttt{month}
columns}{Create year and month columns}}\label{create-year-and-month-columns}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{economics[}\StringTok{\textquotesingle{}year\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ economics[}\StringTok{\textquotesingle{}date\textquotesingle{}}\NormalTok{].dt.year}
\NormalTok{economics[}\StringTok{\textquotesingle{}month\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ economics[}\StringTok{\textquotesingle{}date\textquotesingle{}}\NormalTok{].dt.month}
\NormalTok{economics}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          date      pce     pop  psavert  uempmed  unemploy  year  month
0   1967-07-01    507.4  198712     12.5      4.5      2944  1967      7
1   1967-08-01    510.5  198911     12.5      4.7      2945  1967      8
2   1967-09-01    516.3  199113     11.7      4.6      2958  1967      9
3   1967-10-01    512.9  199311     12.5      4.9      3143  1967     10
4   1967-11-01    518.1  199498     12.5      4.7      3066  1967     11
..         ...      ...     ...      ...      ...       ...   ...    ...
569 2014-12-01  12122.0  320201      5.0     12.6      8688  2014     12
570 2015-01-01  12080.8  320367      5.5     13.4      8979  2015      1
571 2015-02-01  12095.9  320534      5.7     13.1      8705  2015      2
572 2015-03-01  12161.5  320707      5.2     12.2      8575  2015      3
573 2015-04-01  12158.9  320887      5.6     11.7      8549  2015      4

[574 rows x 8 columns]
\end{verbatim}

\section{Time series visualisation using grammar of graphics:
Python}\label{time-series-visualisation-using-grammar-of-graphics-python}

{[}See the tutorial here

{]}(https://thiyangt.github.io/spts\_python\_practical/Practical1/)

\section{What is a lag value?}\label{what-is-a-lag-value}

In time series analysis, a lag represents the number of time steps by
which a series is shifted backward to compare it with itself.

Lag 1: Compare each value with the previous observation.

Lag 2: Compare each value with the value two steps before.

Lag k: Compare each value with the value k steps earlier.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}

\CommentTok{\# Small time series with 5 points}
\NormalTok{data }\OperatorTok{=}\NormalTok{ [}\DecValTok{10}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{14}\NormalTok{]}
\NormalTok{dates }\OperatorTok{=}\NormalTok{ pd.date\_range(start}\OperatorTok{=}\StringTok{\textquotesingle{}2025{-}01{-}01\textquotesingle{}}\NormalTok{, periods}\OperatorTok{=}\DecValTok{5}\NormalTok{, freq}\OperatorTok{=}\StringTok{\textquotesingle{}D\textquotesingle{}}\NormalTok{)}

\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{: dates, }\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{: data\})}
\NormalTok{df.set\_index(}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{, inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}

\CommentTok{\# Create lagged series}
\NormalTok{df[}\StringTok{\textquotesingle{}Lag1\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{].shift(}\DecValTok{1}\NormalTok{)  }\CommentTok{\# lag 1}
\NormalTok{df[}\StringTok{\textquotesingle{}Lag2\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{].shift(}\DecValTok{2}\NormalTok{)  }\CommentTok{\# lag 2}

\CommentTok{\# Show the result}
\BuiltInTok{print}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
            Value  Lag1  Lag2
Date                         
2025-01-01     10   NaN   NaN
2025-01-02     12  10.0   NaN
2025-01-03     13  12.0  10.0
2025-01-04     15  13.0  12.0
2025-01-05     14  15.0  13.0
\end{verbatim}

\section{Correlation vs
Autocorrelation}\label{correlation-vs-autocorrelation}

\subsection{Correlation}\label{correlation}

Measures the strength of the linear relationship between two variables

\[r = \frac{\sum_{i=1}^{n} (x_i -\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^{n} (x_i -\bar{x})^2 \sum_{i=1}^{n} (y_i -\bar{y})^2}}\]

\subsection{Autocorrelation}\label{autocorrelation}

Measures the strength of linear relationship between lagged values of
time series.

\[r_k = \frac{\sum (y_t -\bar{y})(y_{t-k}-\bar{y})}{\sum (y_t -\bar{y})^2}\]

\section{Your turn: why different
values?}\label{your-turn-why-different-values}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Correlation (autocorrelation) between original series and lagged series}
\NormalTok{autocorr\_lag1 }\OperatorTok{=}\NormalTok{ df[}\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{].corr(df[}\StringTok{\textquotesingle{}Lag1\textquotesingle{}}\NormalTok{])}
\NormalTok{autocorr\_lag2 }\OperatorTok{=}\NormalTok{ df[}\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{].corr(df[}\StringTok{\textquotesingle{}Lag2\textquotesingle{}}\NormalTok{])}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Autocorrelation at lag 1: }\SpecialCharTok{\{}\NormalTok{autocorr\_lag1}\SpecialCharTok{:.3f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Autocorrelation at lag 1: 0.744
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Autocorrelation at lag 2: }\SpecialCharTok{\{}\NormalTok{autocorr\_lag2}\SpecialCharTok{:.3f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Autocorrelation at lag 2: 0.655
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{from}\NormalTok{ statsmodels.tsa.stattools }\ImportTok{import}\NormalTok{ acf}

\CommentTok{\# Small time series with 5 points}
\NormalTok{data }\OperatorTok{=}\NormalTok{ [}\DecValTok{10}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{14}\NormalTok{]}
\NormalTok{dates }\OperatorTok{=}\NormalTok{ pd.date\_range(start}\OperatorTok{=}\StringTok{\textquotesingle{}2025{-}01{-}01\textquotesingle{}}\NormalTok{, periods}\OperatorTok{=}\DecValTok{5}\NormalTok{, freq}\OperatorTok{=}\StringTok{\textquotesingle{}D\textquotesingle{}}\NormalTok{)}

\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{: dates, }\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{: data\})}
\NormalTok{df.set\_index(}\StringTok{\textquotesingle{}Date\textquotesingle{}}\NormalTok{, inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}

\BuiltInTok{print}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
            Value
Date             
2025-01-01     10
2025-01-02     12
2025-01-03     13
2025-01-04     15
2025-01-05     14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compute autocorrelation for lags 1 to 4 (max lag = n{-}1)}
\NormalTok{autocorr\_values }\OperatorTok{=}\NormalTok{ acf(df[}\StringTok{\textquotesingle{}Value\textquotesingle{}}\NormalTok{], nlags}\OperatorTok{=}\DecValTok{4}\NormalTok{, fft}\OperatorTok{=}\VariableTok{False}\NormalTok{)}

\CommentTok{\# Show autocorrelation values}
\ControlFlowTok{for}\NormalTok{ lag, val }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(autocorr\_values):}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Lag }\SpecialCharTok{\{}\NormalTok{lag}\SpecialCharTok{\}}\SpecialStringTok{: }\SpecialCharTok{\{}\NormalTok{val}\SpecialCharTok{:.3f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Lag 0: 1.000
Lag 1: 0.349
Lag 2: -0.141
Lag 3: -0.481
Lag 4: -0.227
\end{verbatim}

\section{Autocorrelation plots (ACF)}\label{autocorrelation-plots-acf}

The ACF measures the correlation between a time series and lagged
versions of itself. It tells us how past values influence current
values.

\subsection{Example 1}\label{example-1}

Time series plot

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fable)}
\FunctionTok{library}\NormalTok{(fpp2)}
\FunctionTok{autoplot}\NormalTok{(beer)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-27-1.pdf}}

Seasonal plot

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggseasonplot}\NormalTok{(beer, }\AttributeTok{year.labels=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{year.labels.left=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-28-1.pdf}}

ACF

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggAcf}\NormalTok{(beer)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-29-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggseasonplot}\NormalTok{(beer, }\AttributeTok{year.labels=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{year.labels.left=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-30-1.pdf}}

\section{Example 2}\label{example-2}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{aelec }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(elec, }\AttributeTok{start=}\DecValTok{1980}\NormalTok{)}
\FunctionTok{autoplot}\NormalTok{(aelec) }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"GWh"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-31-1.pdf}}

Seasonal plots

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggseasonplot}\NormalTok{(aelec, }\AttributeTok{year.labels=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{year.labels.left=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-32-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggAcf}\NormalTok{(aelec, }\AttributeTok{lag=}\DecValTok{48}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-33-1.pdf}}

\section{Example 3}\label{example-3}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{50}\NormalTok{))}
\FunctionTok{autoplot}\NormalTok{(y) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"White noise"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-34-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggAcf}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{02-chap2_files/figure-pdf/unnamed-chunk-35-1.pdf}}

\section{Exercise}\label{exercise}

Question 6 at \url{https://otexts.com/fpp2/graphics-exercises.html}

\bookmarksetup{startatroot}

\chapter{Introduction to Time Series
Forecasting}\label{introduction-to-time-series-forecasting}

\section{Notation}\label{notation}

\(\hat{Y}_{T+h|T}\) - The forecast of the time series \(ùëå\) at time
\(T+h\), made using the information available up to time \(T\).

\section{Simple time series forecasting
techniques}\label{simple-time-series-forecasting-techniques}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Average method
\item
  Naive method/ random walk method
\item
  Seasonal naive method
\item
  Drift method
\end{enumerate}

\href{https://otexts.com/fpp2/simple-methods.html}{Reading}

\section{Example: Electricity Demand
Forecasting}\label{example-electricity-demand-forecasting}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fable)}
\FunctionTok{library}\NormalTok{(fpp2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{aelec }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(elec, }\AttributeTok{start=}\DecValTok{1980}\NormalTok{)}
\FunctionTok{autoplot}\NormalTok{(aelec)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-3-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot some forecasts}
\FunctionTok{autoplot}\NormalTok{(aelec) }\SpecialCharTok{+}
  \FunctionTok{autolayer}\NormalTok{(}\FunctionTok{meanf}\NormalTok{(aelec, }\AttributeTok{h=}\DecValTok{11}\NormalTok{),}
    \AttributeTok{series=}\StringTok{"Mean"}\NormalTok{, }\AttributeTok{PI=}\ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{autolayer}\NormalTok{(}\FunctionTok{naive}\NormalTok{(aelec, }\AttributeTok{h=}\DecValTok{11}\NormalTok{),}
    \AttributeTok{series=}\StringTok{"Na√Øve"}\NormalTok{, }\AttributeTok{PI=}\ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{autolayer}\NormalTok{(}\FunctionTok{snaive}\NormalTok{(aelec, }\AttributeTok{h=}\DecValTok{11}\NormalTok{),}
    \AttributeTok{series=}\StringTok{"Seasonal na√Øve"}\NormalTok{, }\AttributeTok{PI=}\ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Forecasts from Mean, NAIVE and SNAIVE"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"Value"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{colour=}\FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{title=}\StringTok{"Forecast"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-4-1.pdf}}

\section{Time Series and Stochastic
Processes}\label{time-series-and-stochastic-processes}

The terms stochastic processes and time series are closely related but
not the same.

A \textbf{stochastic process} is a collection of random variables
indexed by time (or space).

\[\{X_t : t \in T\},\]

where \(T\) is the index set (e.g., discrete or continuous time).

A \textbf{time series} is a single realization (observed data) of a
stochastic process. It is the actual sequence of observations collected
over time.

In short:

Stochastic process = model/theory (all possible sequences). The
probability mechanism (all possible paths).

Time series = observed data (one sequence). One observed path (the
single trajectory we actually have).

\section{Statistical Properties}\label{statistical-properties}

\subsection{Mean function}\label{mean-function}

Let \({X_1, X_2, ...}\) be a sequence of time index random variables.

The \textbf{mean function} of \({X_t}\) is

\[\mu_X(t)=E(X_t).\]

\subsection{Covariance function}\label{covariance-function}

The \textbf{covariance function} of \({X_t}\) is

\[\gamma_X(r, s)=Cov(X_r, X_s)=E[(X_r-\mu_X(r))(X_s-\mu_X(s))]\]

for all integers \((r)\) and \((s)\).

\subsection{Autocovariance function}\label{autocovariance-function}

The autocovariance function of \({X_t}\) at lag \((h)\) is defined by
\[\gamma_X(h):=\gamma_X(h, 0)=\gamma(t+h, t)=Cov(X_{t+h}, X_t).\]

or

The autocovariance function of \({X_t}\) at lag \((h)\) is

\[\gamma_X(h)=Cov(X_{t+h}, X_t).\]

\subsection{Autocorrelation function}\label{autocorrelation-function}

The autocorrelation function of \({X_t}\) at lag \((h)\) is

\[\rho_X(h)=\frac{\gamma_X(h)}{\gamma_X(0)}=Cor(X_{t+h}, X_t).\]

\section{Weakly stationary}\label{weakly-stationary}

A time series \({X_t}\) is called weakly stationary if

\begin{itemize}
\item
  \(\mu_X(t)\) is independent of \(t\).
\item
  \(Var(X_t) = \sigma^2\), Variance is constant. 2
\item
  \(\gamma_X(t+h, t)\) is independent of \((t)\) for each \((h)\). The
  autocovariance depends only on the lag (\(\gamma(h)\) depends only on
  how far apart two points are (\(h\)), and not on the actual time
  \(t\).
\end{itemize}

In other words the statistical properties of the time series (mean,
variance, autocorrelation, etc.) do not depend on the time at which the
series is observed, that is no trend or seasonality. However, a time
series with cyclic behaviour (but with no trend or seasonality) is
stationary.

\section{Strict stationarity of a time
series}\label{strict-stationarity-of-a-time-series}

A time series \(\{X_t\}\) is called strictly stationary if the random
vector \([X_1, X_2..., X_n]\) and \([X_{1+h}, X_{2+h}..., X_{n+h}]\)
have the same joint distribution for all integers \((h)\) and
\((n > 0)\).

\section{1. independent and identically distributed (iid)
noise}\label{independent-and-identically-distributed-iid-noise}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  no trend or seasonal component
\item
  observations are independent and identically distributed (iid) random
  variables with zero mean.
\item
  Notation: \({X_t} \sim IID(0, \sigma^2)\)
\item
  plays an important role as a building block for more complicated time
  series.
\end{enumerate}

\section{2. White noise}\label{white-noise}

If \({X_t}\) is a sequence of uncorrelated random variables, each with
zero mean and variance \(\sigma^2\), then such a sequence is referred to
as \textbf{white noise}.

\section{\texorpdfstring{Every \((IID(0, \sigma^2)\) sequence is
\((WN(0, \sigma^2)\) but not conversely.
Why?}{Every (IID(0, \textbackslash sigma\^{}2) sequence is (WN(0, \textbackslash sigma\^{}2) but not conversely. Why?}}\label{every-iid0-sigma2-sequence-is-wn0-sigma2-but-not-conversely.-why}

\subsection{1. White Noise (WN)}\label{white-noise-wn}

A sequence \(\{X_t\}\) is called \textbf{white noise} with mean \(0\)
and variance \(\sigma^2\), written \(WN(0, \sigma^2)\), if:

\begin{itemize}
\tightlist
\item
  \(\mathbb{E}[X_t] = 0\) for all \(t\).\\
\item
  \(\mathrm{Var}(X_t) = \sigma^2\) for all \(t\).\\
\item
  \(\mathrm{Cov}(X_t, X_s) = 0\) for all \(t \neq s\) (uncorrelated
  across time).
\end{itemize}

Notice: \emph{uncorrelated \(\neq\) independent}.

\subsection{\texorpdfstring{2. i.i.d.
\((0, \sigma^2)\)}{2. i.i.d. (0, \textbackslash sigma\^{}2)}}\label{i.i.d.-0-sigma2}

A sequence \(\{X_t\}\) is \(IID(0, \sigma^2)\) if:

\begin{itemize}
\tightlist
\item
  \(\mathbb{E}[X_t] = 0\).\\
\item
  \(\mathrm{Var}(X_t) = \sigma^2\).\\
\item
  \(X_t\) are independent and identically distributed.
\end{itemize}

\subsection{\texorpdfstring{3. Why every \(IID(0, \sigma^2)\) is
\(WN(0, \sigma^2)\)}{3. Why every IID(0, \textbackslash sigma\^{}2) is WN(0, \textbackslash sigma\^{}2)}}\label{why-every-iid0-sigma2-is-wn0-sigma2}

\begin{itemize}
\tightlist
\item
  Independence \(\;\Rightarrow\;\) zero correlation.\\
\item
  So, an i.i.d. sequence automatically satisfies the white noise
  conditions (same mean, same variance, no correlation).
\end{itemize}

Therefore:

\[
IID(0, \sigma^2) \;\;\Rightarrow\;\; WN(0, \sigma^2).
\]

\subsection{4. Why not conversely?}\label{why-not-conversely}

The reverse is not always true, because \textbf{white noise only
requires uncorrelatedness, not full independence}.

That means a sequence could be white noise but still have dependence in
higher moments (nonlinear dependence).

\section{5. Example of WN but not IID}\label{example-of-wn-but-not-iid}

Let \(\{Z_t\}\) be i.i.d. \(N(0,1)\). Define

\[
X_t = Z_t \cdot Z_{t-1}.
\]

Then:

\begin{itemize}
\tightlist
\item
  \(\mathbb{E}[X_t] = 0\),\\
\item
  \(\mathrm{Var}(X_t) = 1\),\\
\item
  For \(t \neq s\), \(\mathrm{Cov}(X_t, X_s) = 0\). ‚úÖ So it's white
  noise.
\end{itemize}

But the sequence is \textbf{not independent} (because \(X_t\) depends on
\(Z_{t-1}\), which also appears in \(X_{t-1}\)).

Thus,

\[
X_t \sim WN(0,1) \quad \text{but not} \quad IID(0,1).
\]

\section{Simulation example}\label{simulation-example}

IID series

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Parameters}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{200}        \CommentTok{\# length of series}
\NormalTok{sigma }\OtherTok{\textless{}{-}} \DecValTok{1}      \CommentTok{\# standard deviation}

\CommentTok{\# IID(0, sigma\^{}2) \textasciitilde{} Normal(0, sigma\^{}2)}
\NormalTok{iid\_seq }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =}\NormalTok{ sigma)}

\CommentTok{\# Quick check}
\FunctionTok{mean}\NormalTok{(iid\_seq)      }\CommentTok{\# should be \textasciitilde{}0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -0.008570445
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{var}\NormalTok{(iid\_seq)       }\CommentTok{\# should be \textasciitilde{}sigma\^{}2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.8895506
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(iid\_seq)       }\CommentTok{\# autocorrelations \textasciitilde{} 0}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-5-1.pdf}}

White noise

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{200}
\NormalTok{Z }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}

\CommentTok{\# Construct WN but not IID}
\NormalTok{wn\_not\_iid }\OtherTok{\textless{}{-}}\NormalTok{ Z[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ Z[}\SpecialCharTok{{-}}\NormalTok{n]   }\CommentTok{\# X\_t = Z\_t * Z\_\{t{-}1\}, length n{-}1}

\CommentTok{\# Quick check}
\FunctionTok{mean}\NormalTok{(wn\_not\_iid)        }\CommentTok{\# \textasciitilde{}0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -0.05650406
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{var}\NormalTok{(wn\_not\_iid)         }\CommentTok{\# \textasciitilde{}1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.8196189
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(wn\_not\_iid)         }\CommentTok{\# uncorrelated {-}\textgreater{} ACF \textasciitilde{} 0}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-6-1.pdf}}

Side-by-side visualisation

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-7-1.pdf}}

\section{3. Random walk}\label{random-walk}

A random walk process is obtained by cumulatively summing iid random
variables. If \({S_t, t=0, 1, 2, ...}\) is a random walk process, then
\(S_0 =0\)

\(S_1=0+X_1\)

\(S_2=0+X_1+X_2\)

\(...\)

\(S_t=X_1+X_2+...+X_t.\)

\textbf{Question}

Is \({S_t, t=0, 1, 2, ...}\) a weak stationary process?

\section{Identifying non-stationarity in the
mean}\label{identifying-non-stationarity-in-the-mean}

\begin{itemize}
\item
  Using time series plot
\item
  ACF plot

  \begin{itemize}
  \item
    ACF of stationary time series will drop to relatively quickly.
  \item
    The ACF of non-stationary series decreases slowly.
  \item
    For non-stationary series, the ACF at lag 1 is often large and
    positive.
  \end{itemize}
\end{itemize}

\section{Backshift notation:}\label{backshift-notation}

\[BX_t=X_{t-1}\]

\section{Ordinary differencing}\label{ordinary-differencing}

The first-order differencing can be defined as

\[\nabla X_t = X_t-X_{t-1}=X_t-BX_t=(1-B)X_t\] where \(\nabla=1-B\).

The second-order differencing

\[\nabla^2X_t=\nabla(\nabla X_t)=\nabla(X_t-X_{t-1})=\nabla X_t - \nabla X_{t-1}\]

\[\nabla X_t - \nabla X_{t-1}=(X_t-X_{t-1})-(X_{t-1}-X_{t-2})\]

In practice, we seldom need to go beyond second order differencing.

\section{Seasonal differencing}\label{seasonal-differencing}

Differencing between an observation and the corresponding observation
from the previous year.

\[\nabla_mX_t=X_t-X_{t-m}=(1-B^m)X_t\] where \((m)\) is the number of
seasons. For monthly, \((m=12)\), for quarterly \((m=4)\).

For monthly series

\[\nabla_{12}X_t=X_t-X_{t-12}\]

\section{Twice-differenced series}\label{twice-differenced-series}

\[\nabla^2_{12}X_t=\nabla_{12}X_t-\nabla_{12}X_{t-1}\]
\[\nabla_{12}X_t-\nabla_{12}X_{t-1}=(X_t-X_{t-12})-(X_{t-1}-X_{t-13})\]
If seasonality is strong, the seasonal differencing should be done
first.

\section{Deterministic trend vs Stochastic
trend}\label{deterministic-trend-vs-stochastic-trend}

\subsection{Deterministic trend}\label{deterministic-trend}

\[Y_t  = f(t) + \epsilon_t\]

where \(\epsilon_t \sim iid(0, \sigma^2)\), \(t = 1, 2, ...T\)

Mean of the process is time dependent, but the variance of the process
is constant.

A trend is deterministic if it is a nonrandom function of time. A
deterministic trend is a predictable, fixed function of time. If you
know the form of the function, you can determine the trend exactly.

\subsection{Stochastic trend}\label{stochastic-trend}

A stochastic trend is driven by random shocks that accumulate over time.
A stochastic trend is driven by random shocks (also called innovations,
disturbances, or error terms) that accumulate over time.

\textbf{1. Random walk}

\[Y_t = Y_{t-1} + \epsilon_t\]

\begin{itemize}
\item
  Random walk has a stochastic trend.
\item
  Model behind naive method.
\end{itemize}

A trend is said to be stochastic if it is a random function of time.

\textbf{2. Random walk with drift}

\[Y_t = \alpha +  Y_{t-1} + \epsilon_t\]

\begin{itemize}
\item
  Random walk with drift has a stochastic trend and a deterministic
  trend.
\item
  Model behind drift method.
\end{itemize}

\section{Random walk}\label{random-walk-1}

\[
\begin{aligned}
  Y_t &= Y_{t-1} + \epsilon_t \\
     Y_1    &= Y_0 + \epsilon_1 \\
         Y_2 &=  Y_1 + \epsilon_2=Y_0 + \epsilon_1 + \epsilon_2\\
          Y_3 &=  Y_2 + \epsilon_3=Y_0 + \epsilon_1 + \epsilon_2 +\epsilon_3\\
          .   \\
          Y_t &=Y_{t-1} + \epsilon_t=Y_0 + \epsilon_1 + \epsilon_2 + \epsilon_3 +...+ \epsilon_t = Y_0 + \sum_{i=1}^{t} \epsilon_t
\end{aligned}
\]

Mean: \(E(Y_t) = Y_0\).

Variance: \(Var(Y_t)=t \sigma^2\).

\section{Random walk with drift}\label{random-walk-with-drift}

\[
\begin{aligned}
  Y_t &= \alpha + Y_{t-1} + \epsilon_t \\
     Y_1    &= \alpha+Y_0 + \epsilon_1 \\
         Y_2 &= \alpha+ Y_1 + \epsilon_2=2 \alpha+Y_0 + \epsilon_1 + \epsilon_2\\
          Y_3 &= \alpha+ Y_2 + \epsilon_3= 3 \alpha+ Y_0 + \epsilon_1 + \epsilon_2 +\epsilon_3\\
          .   \\
          Y_t &= \alpha+Y_{t-1} + \epsilon_t= t \alpha+ Y_0 + \epsilon_1 + \epsilon_2 + \epsilon_3 +...+ \epsilon_t \\
          Y_t &= t \alpha + Y_0 + \sum_{i=1}^{t} \epsilon_t
\end{aligned}
\]

It has a \emph{deterministic trend} \((Y_0 + t \alpha)\) and a
\emph{stochastic trend} \(\sum_{i=1}^{t} \epsilon_t\).

Mean: \(E(Y_t) = Y_0 + t\alpha\)

Variance: \(Var(Y_t) = t\sigma^2\).

There is a trend in both mean and variance.

\section{Common trend removal (de-trending)
procedures}\label{common-trend-removal-de-trending-procedures}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Deterministic trend: Time-trend regression

  The trend can be removed by fitting a deterministic polynomial time
  trend. The residual series after removing the trend will give us the
  de-trended series.
\item
  Stochastic trend: Differencing

  The process is also known as a \textbf{Difference-stationary process}.
\end{enumerate}

\section{Remove seasonality}\label{remove-seasonality}

Take seasonal differencing

\section{Example: Differencing on AirPassengers
Data}\label{example-differencing-on-airpassengers-data}

The built-in AirPassengers dataset (monthly airline passengers,
1949--1960) has trend + seasonality.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load data}
\FunctionTok{data}\NormalTok{(}\StringTok{"AirPassengers"}\NormalTok{)}
\NormalTok{ts\_data }\OtherTok{\textless{}{-}}\NormalTok{ AirPassengers}

\CommentTok{\#par(mfrow = c(3,2))}

\CommentTok{\# 1. Original series}
\FunctionTok{plot}\NormalTok{(ts\_data, }\AttributeTok{main =} \StringTok{"Original Series"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Passengers"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(ts\_data, }\AttributeTok{main =} \StringTok{"ACF: Original Series"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-2.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 2. First difference (remove trend)}
\NormalTok{diff1 }\OtherTok{\textless{}{-}} \FunctionTok{diff}\NormalTok{(ts\_data, }\AttributeTok{differences =} \DecValTok{1}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(diff1, }\AttributeTok{main =} \StringTok{"1st Difference (Remove Trend)"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Difference"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-3.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(diff1, }\AttributeTok{main =} \StringTok{"ACF: 1st Difference"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-4.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 3. Seasonal difference (lag = 12, remove seasonality)}
\NormalTok{diff\_seasonal }\OtherTok{\textless{}{-}} \FunctionTok{diff}\NormalTok{(diff1, }\AttributeTok{lag =} \DecValTok{12}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(diff\_seasonal, }\AttributeTok{main =} \StringTok{"Seasonal Difference (Remove Seasonality)"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Difference"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-5.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(diff\_seasonal, }\AttributeTok{main =} \StringTok{"ACF: Seasonal Difference"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-6.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 3. Seasonal difference (lag = 12, remove seasonality from the original series)}
\NormalTok{diff\_seasonal\_only }\OtherTok{\textless{}{-}} \FunctionTok{diff}\NormalTok{(ts\_data, }\AttributeTok{lag =} \DecValTok{12}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(diff\_seasonal\_only, }\AttributeTok{main =} \StringTok{"Seasonal Difference (Remove Seasonality)"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Difference"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-7.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(diff\_seasonal\_only, }\AttributeTok{main =} \StringTok{"ACF: Seasonal Difference"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-8-8.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(ts\_data, }\DecValTok{14}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949 112 118 132 129 121 135 148 148 136 119 104 118
1950 115 126                                        
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(diff1, }\DecValTok{14}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1949       6  14  -3  -8  14  13   0 -12 -17 -15  14
1950  -3  11  15                                    
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(diff\_seasonal, }\DecValTok{14}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1950       5   1  -3  -2  10   8   0   0  -8  -4  12
1951   8  -6  13                                    
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(diff\_seasonal\_only, }\DecValTok{14}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
1950   3   8   9   6   4  14  22  22  22  14  10  22
1951  30  24                                        
\end{verbatim}

\section{Notation: I(d)}\label{notation-id}

Integrated to order \(d\): Series can be made stationary by differencing
\(d\) times.

\begin{itemize}
\tightlist
\item
  Known as \(I(d)\) process.
\end{itemize}

\textbf{Question:} Show that random walk process is an \(I(1)\) process.

The random walk process is called a unit root process. (If one of the
roots turns out to be one, then the process is called unit root
process.)

\section{Variance stabilization}\label{variance-stabilization}

Transform the series.

Eg:

\begin{itemize}
\item
  Square root: \(W_t = \sqrt{Y_t}\)
\item
  Logarithm: \(W_t = log({Y_t})\)

  \begin{itemize}
  \item
    This very useful.
  \item
    Interpretable: Changes in a log value are \textbf{relative (percent)
    changes on the original sclae}.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log\_ts }\OtherTok{\textless{}{-}} \FunctionTok{log}\NormalTok{(ts\_data)}
\FunctionTok{plot}\NormalTok{(log\_ts, }\AttributeTok{main =} \StringTok{"Log{-}Transformed Series"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"log(Passengers)"}\NormalTok{, }\AttributeTok{col =} \StringTok{"steelblue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{03-chap3_files/figure-pdf/unnamed-chunk-10-1.pdf}}

\bookmarksetup{startatroot}

\chapter{Models For Stationary Time
Series}\label{models-for-stationary-time-series}

In this chapter we will discuss family of autoregressive moving average
(ARMA) time series models.

\section{General Linear Process}\label{general-linear-process}

A \textbf{linear process} is a time series written as an infinite linear
combination of random shocks \(\{\varepsilon_t\}\). These shocks are
randomly drawn from a fixed distribution, usually Normal and having mean
zero and variance \(\sigma^2_{\epsilon}\). Such a sequence is called a
white noise process.

\[X_t = \mu + \sum_{j=0}^{\infty} \psi_j \, \varepsilon_{t-j},\]

or

\[X_t = \mu + \Psi(B)\epsilon_t\]

where,

\(\mu\) is a parameter that determines the ``level'' of the process

\(\{\psi_j\}\) are coefficients (weights)

\(\varepsilon_t \sim \text{i.i.d. } (0, \sigma^2_\epsilon)\) are white
noise shocks.

\(\Psi(B)\) is the linear operator that transforms \(\epsilon_t\) into
\(X_t\). This is called transfer function or linear filter.

\section{Moving Average Processes}\label{moving-average-processes}

If only finitely many coefficients \(\psi_j\) are nonzero, say up to lag
\(q\), then we have an MA(\(q\)) process:

\[X_t = \mu + \varepsilon_t + \theta_1 \varepsilon_{t-1} + \dots + \theta_q \varepsilon_{t-q},\]

where:

\begin{itemize}
\item
  \(\mu\) is the mean,
\item
  \(\varepsilon_t \sim \text{i.i.d. }(0, \sigma^2)\) are white noise
  shocks,
\item
  \(\theta_1, \dots, \theta_q\) are the MA coefficients.
\end{itemize}

So we can write:

\[\text{MA}(q) \subset \text{Linear Process}.\]

\section{Autoregressive Processes}\label{autoregressive-processes}

\(Y_t = \alpha + \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \dots + \phi_p Y_{t-p} + \epsilon_t\)

Where:

\(Y_t\) is the value at time \(t\)

\(\alpha\) is a constant,

\(\phi_1, \phi_2,...\phi_p\) are the parameters,

\(\epsilon_t\) is white noise (error term),

\(p\) is the order of the AR model.

\section{AR processes are also just special cases of the general linear
process}\label{ar-processes-are-also-just-special-cases-of-the-general-linear-process}

If the AR process is causal (i.e., roots of the characteristic
polynomial lie outside the unit circle), then it can be written as an
infinite linear process:

\[X_t = \sum_{j=0}^{\infty} \psi_j \, \varepsilon_{t-j},\]

where:

\begin{itemize}
\item
  \(\varepsilon_t \sim \text{i.i.d. }(0, \sigma^2)\) are white noise
  shocks,
\item
  \(\psi_j\) are coefficients determined from the AR parameters.
\end{itemize}

\subsection{AR(p) Process as an Infinite Linear Process Using Backshift
Operator}\label{arp-process-as-an-infinite-linear-process-using-backshift-operator}

Start with the AR(p) process:

\[X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \dots + \phi_p X_{t-p} + \varepsilon_t,\]

where \(\varepsilon_t \sim \text{i.i.d. }(0, \sigma^2)\) are white noise
shocks.

\subsubsection{1. Define the backshift operator
(B)}\label{define-the-backshift-operator-b}

\[B X_t = X_{t-1}, \quad B^2 X_t = X_{t-2}, \dots, B^p X_t = X_{t-p}.\]

\subsubsection{2. Rewrite the AR(p) process using
(B)}\label{rewrite-the-arp-process-using-b}

\[X_t - \phi_1 B X_t - \phi_2 B^2 X_t - \dots - \phi_p B^p X_t = \varepsilon_t\]

Factor out \(X_t\):

\[(1 - \phi_1 B - \phi_2 B^2 - \dots - \phi_p B^p) X_t = \varepsilon_t\]

Define the AR polynomial:

\[\phi(B) = 1 - \phi_1 B - \phi_2 B^2 - \dots - \phi_p B^p\]

Then the AR(p) process becomes:

\[\phi(B) X_t = \varepsilon_t\]

\subsubsection{3. Express as an infinite linear
process}\label{express-as-an-infinite-linear-process}

If the AR process is \textbf{causal} (roots of \(\phi(z)=0\) lie outside
the unit circle), we can invert the operator:

\[X_t = \phi(B)^{-1} \varepsilon_t\]

Expanding gives:

\[X_t = \sum_{j=0}^{\infty} \psi_j \, \varepsilon_{t-j},\]

where the coefficients \(\psi_j\) are determined recursively from the AR
parameters \(\phi_1, \dots, \phi_p\).

This shows that causal AR processes are \textbf{special cases of the
general linear process}.

\section{In-class: Properties of AR(1)
process}\label{in-class-properties-of-ar1-process}

Derive

\begin{itemize}
\item
  Mean
\item
  Variance
\item
  Covariance
\item
  Autocorrelation function of an AR(1) process
\end{itemize}

\section{In-class: Properties of AR(2)
process}\label{in-class-properties-of-ar2-process}

Derive

\begin{itemize}
\item
  Mean
\item
  Variance
\item
  Covariance
\item
  Autocorrelation function of an AR(1) process
\end{itemize}

\section{In-class: Properties of AR(P)
process}\label{in-class-properties-of-arp-process}

Derive

\begin{itemize}
\item
  Mean
\item
  Variance
\item
  Covariance
\item
  Autocorrelation function of an AR(P) process
\end{itemize}

\section{Properties of AR(1) model}\label{properties-of-ar1-model}

Consider the following \(AR(1)\) model.

\begin{equation}
Y_t=\phi_0+\phi_1Y_{t-1}+\epsilon_{t}
\end{equation}

where \({\epsilon_t}\) is assumed to be a white noise process with mean
zero and variance \(\sigma^2\).

\subsection{Mean}\label{mean}

Assuming that the series is weak stationary, we have \(E(Y_t)=\mu\),
\(Var(Y_t)=\gamma_0\), and \(Cov(Y_t, Y_{t-k})=\gamma_k\), where \(\mu\)
and \(\gamma_0\) are constants. Given that \({\epsilon_t}\) is a white
noise, we have \(E(\epsilon_t)=0\). The mean of \(AR(1)\) process can be
computed as follows:

\[
\begin{aligned}
  E(Y_t) &= E(\phi_0+\phi_1 Y_{t-1}) \\
         &= E(\phi_0) +E(\phi_1 Y_{t-1}) \\
         &= \phi_0 +\phi_1 E(Y_{t-1}). \\
\end{aligned}
\]

Under the stationarity condition, \(E(Y_t)=E(Y_{t-1})=\mu\). Thus we get

\[\mu = \phi_0+\phi_1\mu.\]

Solving for \(\mu\) yields

\begin{equation}
E(Y_t)=\mu=\frac{\phi_0}{1-\phi_1}.
\end{equation}

The results has two constraints for \(Y_t\). First, the mean of \(Y_t\)
exists if \(\phi_1 \neq 1 .\) The mean of \(Y_t\) is zero if and only if
\(\phi_0=0\).

\subsection{Variance and the stationary condition of AR (1)
process}\label{variance-and-the-stationary-condition-of-ar-1-process}

First take variance of both sides of Equation (1)

\[Var(Y_t)=Var(\phi_0+\phi_1 Y_{t-1}+\epsilon_t)\]

The \(Y_{t-1}\) occurred before time \(t\). The \(\epsilon_t\) does not
depend on any past observation. Hence, \(cov(Y_{t-1}, \epsilon_t)= 0\).
Furthermore, \({\epsilon_t}\) is a white noise. This gives

\[Var(Y_t)=\phi_1^2 Var(Y_{t-1})+\sigma^2.\]

Under the stationarity condition, \(Var(Y_t)=Var(Y_{t-1})\). Hence,

\[Var(Y_t)=\frac{\sigma^2}{1-\phi_1^2}.\]

provided that \(\phi_1^2 < 1\) or \(|\phi_1| < 1\) (The variance of a
random variable is bounded and non-negative). The necessary and
sufficient condition for the \(AR(1)\) model in Equation (1) to be
weakly stationary is \(|\phi_1| < 1\). This condition is equivalent to
saying that the root of \(1-\phi_1B = 0\) must lie outside the unit
circle. This can be explained as below

Using the backshift notation we can write \(AR(1)\) process as

\[Y_t = \phi_0 + \phi_1BY_{t} + \epsilon_t.\]

Then we get

\[(1-\phi_1B)Y_t=\phi_0 + \epsilon_t.\] The \(AR(1)\) process is said to
be stationary if the roots of \((1-\phi_1B)=0\) lie outside the unit
circle.

\subsection{Covariance}\label{covariance}

The covariance \(\gamma_k=Cov(Y_t, Y_{t-k})\) is called the lag-\(k\)
autocovariance of \(Y_t\). The two main properties of \(\gamma_k\): (a)
\(\gamma_0=Var(Y_t)\) and (b) \(\gamma_{-k}=\gamma_{k}\).

The lag-\(k\) autocovariance of \(Y_t\) is

\begin{equation}
\begin{aligned}
  \gamma_k &= Cov(Y_t, Y_{t-k}) \\
         &= E[(Y_t-\mu)(Y_{t-k}-\mu)] \\
         &= E[Y_tY_{t-k}-Y_t\mu-\mu Y_{t-k} +\mu^2] \\
         &= E(Y_t Y_{t-k}) - \mu^2. \\
\end{aligned}
\end{equation}

Now we have

\begin{equation}
  E(Y_t Y_{t-k}) = \gamma_k + \mu^2
\end{equation}

\subsection{Autocorrelation function of an AR(1)
process}\label{autocorrelation-function-of-an-ar1-process}

To derive autocorrelation function of an AR(1) process we first multiply
both sides of Equation (1) by \(Y_{t-k}\) and take expected values:

\[E(Y_tY_{t-k})=\phi_0E(Y_{t-k})+\phi_1 E(Y_{t-1}Y_{t-k})+E(\epsilon_tY_{t-k})\]
Since \(\epsilon_t\) and \(Y_{t-k}\) are independent and using the
results in Equation \textbf{?@eq-3}

\[\gamma_k + \mu^2 = \phi_0 \mu+\phi_1(\gamma_{k-1}+\mu^2)\]

Substituting the results in Equation (2) to Equation (3) we get

\begin{equation}
\gamma_k = \phi_1 \gamma_{k-1}.
\end{equation}

The autocorrelation function, \(\rho_k\), is defined as

\[\rho_k = \frac{\gamma_k}{\gamma_0}\].

Setting \(k=1\), we get \(\gamma_1 = \phi_1\gamma_0.\) Hence,

\[\rho_1=\phi_1.\]

Similarly with \(k=2\), \(\gamma_2 = \phi_1 \gamma_1\). Dividing both
sides by \(\gamma_0\) and substituting with \(\rho_1=\phi_1\) we get

\[\rho_2=\phi_1^2.\]

Now it is easy to see that in general

\begin{equation}
\rho_k = \frac{\gamma_k}{\gamma_0}=\phi_1^k 
\end{equation}

for \(k=0, 1, 2, 3, ...\).

Since \(|\phi_1| < 1,\) the autocorrelation function is an exponentially
decreasing as the number of lags \(k\) increases. There are two features
in the ACF of AR(1) process depending on the sign of \(\phi_1\). They
are,

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  If \(0 < \phi_1 < 1,\) all correlations are positive.
\item
  if \(-1 < \phi_1 < 0,\) the lag 1 autocorrelation is negative
  (\(\rho_1=\phi_1\)) and the signs of successive autocorrelations
  alternate from positive to negative with their magnitudes decreasing
  exponentially.
\end{enumerate}

\section{Properties of AR(2) model}\label{properties-of-ar2-model}

Now consider a second-order autoregressive process (AR(2))

\begin{equation}
Y_t=\phi_0+\phi_1Y_{t-1}+\phi_2Y_{t-2}+\epsilon_t.
\end{equation}

\subsection{Mean}\label{mean-1}

\textbf{Question 1:} Using the same technique as that of the AR(1), show
that

\[E(Y_t) = \mu = \frac{\phi_0}{1-\phi_1 - \phi_2}\] and the mean of
\(Y_t\) exists if \(\phi_1 + \phi_2 \neq 1\).

\subsection{Variance}\label{variance}

\textbf{Question 2:} Show that
\[Var(Y_t) = \frac{(1-\phi_2)\sigma^2}{(1+\phi_2)((1+\phi_2)^2-\phi_1^2)}.\]

Here is a guide to the solution

Start with

\[Var(Y_t)=Var(\phi_0+\phi_1Y_{t-1}+\phi_2Y_{t-2}+\epsilon_t)\]

Solve it until you obtain the Eq. (a) as shown below.

\begin{equation}
\gamma_0 (1-\phi_1^2 - \phi_2^2) = 2\phi_1\phi_2\gamma_1+\sigma^2.
\end{equation}

Next multiply both sides of Equation 7 by \(Y_{t-1}\) and obtain an
expression for \(\gamma_1\). Let's call this Eq. (b).

Solve Eq. (a) and (b) for \(\gamma_0.\)

\subsection{Stationarity of AR(2)
process}\label{stationarity-of-ar2-process}

To discuss the stationarity condition of the \(AR(2)\) process we use
the roots of the characteristic polynomial. Here is the illustration.

Using the backshift notation we can write \(AR(2)\) process as

\[Y_t = \phi_0 + \phi_1 BY_{t} + \phi_2 B^2 Y_{t} + \epsilon_t.\]

Furthermore, we get

\[(1-\phi_1 B - \phi_2 B^2) Y_t = \phi_0 + \epsilon_t.\]

The \textbf{characteristic polynomial} of \(AR(2)\) process is

\[\Phi(B)=1-\phi_1 B - \phi_2 B^2.\]

and the corresponding \textbf{AR characteristic equation}

\[1-\phi_1 B - \phi_2 B^2=0.\]

For stationarity, the roots of AR characteristic equation must lie
outside the unit circle. The two roots of the AR characteristic equation
are

\[\frac{\phi_1 \pm \sqrt{\phi_1^2 + 4\phi_2}}{-2\phi_2}\]

Using algebraic manipulation, we can show that these roots will exceed 1
in modulus if and only if simultaneously \(\phi_1 + \phi_2 < 1,\)
\(\phi_2-\phi_1 < 1,\) and \(|\phi_2| < 1.\) This is called the
stationarity condition of \(AR(2)\) process.

\subsection{Autocorrelation function of an AR(2)
process}\label{autocorrelation-function-of-an-ar2-process}

To derive autocorrelation function of an AR(2) process we first multiply
both sides of Equation 7 by \(Y_{t-k}\) and take expected values:

\begin{align}
E(Y_tY_{t-k}) &= E(\phi_0Y_{t-k}+\theta_1Y_{t-1}Y_{t-k}+\theta_2Y_{t-2}Y_{t-k})+\epsilon_tY_{t-k} \\
&= \phi_0 E(Y_{t-k})+\phi_{1}E(Y_{t-1}Y_{t-k}) + \phi_2 E(Y_{t-2} Y_{t-k}) + E(\epsilon_tY_{t-k}).
\end{align}

Using the independence between \(\epsilon_t\) and \(Y_{t-1}\),
\(E(\epsilon_t Y_{t-k})=0\) and the results in Equation 4 (This is valid
for AR(2)) we have

\[\gamma_k + \mu^2 = \gamma_0 \mu + \theta_1 (\gamma_{k-1}+\mu^2)+\phi_2 (\gamma_{k-2}+\mu^2).\]

(Note that \(E(X_{t-1}X_{t-k})=E(X_{t-1}X_{(t-1)-(k-1)}=\gamma_{k-1})\))

Solving for \(\gamma_k\) we get

\begin{align}
 \gamma_k=\phi_1\gamma_{k-1}+\phi_2\gamma_{k-2}.
\end{align}

By dividing the both sides of Equation 10 by \(\gamma_0\), we have

\begin{align}
 \rho_k=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}.
\end{align}

for \(k>0\).

Setting \(k=1\) and using \(\rho_0=1\) and \(\rho_{-1}=\rho_1\), we get
\textbf{the Yule-Walker equation for \(AR(2)\) process.}

\[\rho_1=\phi_1+\phi_2 \rho_1\] or

\[\rho_1 = \frac{\phi_1}{1-\phi_2}.\]

Similarly, we can show that

\[\rho_2 = \frac{\phi_2(1-\phi_2)+\phi_1^2}{(1-\phi_2)}.\]

\section{Properties of AR(p) model}\label{properties-of-arp-model}

The \(p\)th order autoregressive model can be written as

\begin{align}
Y_t = \phi_0 + \phi_1Y_{t-1}+\phi_2 Y_{t-2}+ ... + \phi_p Y_{t-p}+\epsilon_t.
\end{align}

The AR characteristic equation is

\[1-\phi_1B-\phi_2B^2-...-\phi_pB^p=0.\]

For stationarity of \(AR(p)\) process, the \(p\) roots of the AR
characteristic must lie outside the unit circle.

\subsection{Mean}\label{mean-2}

\textbf{Question 3: } Find \(E(Y_t)\) of \(AR(p)\) process.

\subsection{Variance}\label{variance-1}

\textbf{Question 4: } Find \(Var(Y_t)\) of \(AR(p)\) process.

\subsection{Autocorrelation function (ACF) of an AR(p)
process}\label{autocorrelation-function-acf-of-an-arp-process}

\textbf{Question 5: } Similar to the results in Equation 12 for
\(AR(2)\) process, obtain the following recursive relationship for
\(AR(p)\).

\begin{align}
\rho_k = \phi_1\rho_{k-1}+\phi_2 \rho_{k-2} + ... + \phi_p \rho_{k-p}.
\end{align}

Setting \(k=1, 2, ..., p\) into Equation 14 and using \(\rho_0=1\) and
\(\rho_{-k}=\rho_k\), we get the Yule-Walker equations for \(AR(p)\)
process

\begin{equation}
\begin{aligned}
  \rho_1 &= \phi_1+\phi_2 \rho_{1} + ... + \phi_p \rho_{p-1}\\
  \rho_2 &= \phi_1 \rho_1+\phi_2  + ... + \phi_p \rho_{p-2}\\
  ... \\
  \rho_p &= \phi_1 \rho_{p-1} +\phi_2 \rho_{p-2}  + ... + \phi_p \\
\end{aligned}
\end{equation}

The Yule-Walker equations in 14 can be written in matrix form as below.

\[\left[\begin{array}
{r}
\rho_1  \\
\rho_2  \\
.\\
.\\
.\\
\rho_p
\end{array}\right] = \left[\begin{array}
{rrrrrrr}
1 & \rho_1 & \rho_2 & .&.&.& \rho_{p-1} \\
\rho_1 & 1 & \rho_1 & .&.&.& \rho_{p-2} \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
\rho_{p-1} & \rho_{p-2} & \rho_{p-3} & .&.&.& 1 \\
\end{array}\right] \left[\begin{array}
{r}
\phi_1  \\
\phi_2  \\
.\\
.\\
.\\
\phi_p
\end{array}\right]
\]

or

\[\bm{\rho_p}=\bm{P_p\phi}.\]

where,

\[\bm{\rho_p} = \left[\begin{array}
{r}
\rho_1  \\
\rho_2  \\
.\\
.\\
.\\
\rho_p
\end{array}\right], \bm{P_p} = \left[\begin{array}
{rrrrrrr}
1 & \rho_1 & \rho_2 & .&.&.& \rho_{p-1} \\
\rho_1 & 1 & \rho_1 & .&.&.& \rho_{p-2} \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
\rho_{p-1} & \rho_{p-2} & \rho_{p-3} & .&.&.& 1 \\
\end{array}\right], \bm{\phi} = \left[\begin{array}
{r}
\phi_1  \\
\phi_2  \\
.\\
.\\
.\\
\phi_p
\end{array}\right]\]

The parameters can be estimated using

\[\bm{\phi}=\bm{P_p^{-1}\rho_p}.\]

\textbf{Question 6:} Obtain the parameters of an \(AR(3)\) process whose
first autocorrelations are \(\rho_1=0.9\); \(\rho_2=0.9\);
\(\rho_3=0.5\). Is the process stationary?

\section{The partial autocorrelation function
(PACF)}\label{the-partial-autocorrelation-function-pacf}

Let \(\phi_{ki}\), the \(j\)th coefficient in an \(AR(k)\) model. Then,
\(\phi_{kk}\) is the last coefficient. From Equation
\textbf{?@eq-yulep}, the \(\phi_{kj}\) satisfy the set of equations

\begin{equation}
\rho_j=\phi_{k1}\rho_{j-1}+...+\phi_{k(k-1)}\rho_{j-k+1}+\phi_{kk}\rho_{j-k},
\end{equation}

for \(j=1, 2, ...k\), leading to the Yule-Walker equations which may be
written

\begin{equation}
\left[\begin{array}
{r}
\rho_1  \\
\rho_2  \\
.\\
.\\
.\\
\rho_k
\end{array}\right] = \left[\begin{array}
{rrrrrrr}
1 & \rho_1 & \rho_2 & .&.&.& \rho_{k-1} \\
\rho_1 & 1 & \rho_1 & .&.&.& \rho_{k-2} \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
\rho_{k-1} & \rho_{k-2} & \rho_{k-3} & .&.&.& 1 \\
\end{array}\right] \left[\begin{array}
{r}
\phi_{k1}  \\
\phi_{k2}  \\
.\\
.\\
.\\
\phi_{kk}
\end{array}\right]
\end{equation}

or

\[\bm{\rho_k}=\bm{P_k\phi_k}.\]

where

\[\bm{\rho_k} = \left[\begin{array}
{r}
\rho_1  \\
\rho_2  \\
.\\
.\\
.\\
\rho_k
\end{array}\right], \bm{P_k} =\left[\begin{array}
{rrrrrrr}
1 & \rho_1 & \rho_2 & .&.&.& \rho_{k-1} \\
\rho_1 & 1 & \rho_1 & .&.&.& \rho_{k-2} \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
. & . & . & .&.&.& . \\
\rho_{k-1} & \rho_{k-2} & \rho_{k-3} & .&.&.& 1 \\
\end{array}\right], \bm{\phi_k} = \left[\begin{array}
{r}
\phi_{k1}  \\
\phi_{k2}  \\
.\\
.\\
.\\
\phi_{kk}
\end{array}\right]\]

For each \(k\), we compute the coefficients \(\phi_{kk}\). Solving the
equations for \(k=1, 2, 3...\) successively, we obtain

For \(k=1\),

\begin{equation}
\phi_{11}=\rho_1.
\end{equation}

For \(k=2\),

\begin{equation}
\phi_{22}=\frac{\left[\begin{array}
{rr}
1 & \rho_2  \\
\rho_1 & \rho_2  \\
\end{array}\right]}{\left[\begin{array}
{rr}
1 & \rho_1  \\
\rho_1 & 1  \\
\end{array}\right]} = \frac{\rho_2-\rho_1^2}{1-\rho_1^2}
\end{equation}

For \(k=3\),

\begin{equation}
\phi_{33}=\frac{\left[\begin{array}
{rrr}
1 & \rho_1 & \rho_1  \\
\rho_1 & 1 & \rho_2  \\
\rho_2 & \rho_1 & \rho_3  \\
\end{array}\right]}{\left[\begin{array}
{rrr}
1 & \rho_1 & \rho_2  \\
\rho_1 & 1 & \rho_1  \\
\rho_2 & \rho_1 & 1  \\
\end{array}\right]}
\end{equation}

The quantity \(\phi_{kk}\) is called the partial autocorrelation at lag
\(k\) and can be defined as
\[\phi_{kk}=Corr(Y_tY_{t-k}|Y_{t-1}, Y_{t-2},..., Y_{t-k+1}).\] The
partial autocorrelation between \(Y_t\) and \(Y_{t-k}\) is the
correlation between \(Y_t\) and \(Y_{t-k}\) after removing the effect of
the intermediate variables \(Y_{t-1}, Y_{t-2}, ..., Y_{t-k+1}\).

In general the determinant in the numerator of Equations 18, 19 and 20
has the same elements as that in the denominator, but replacing the last
column with \(\bm{\rho_k}= (\rho_1, \rho_2,...\rho_k).\)

\subsection{PACF for AR(1) models}\label{pacf-for-ar1-models}

From Equation 6 we have

\(\rho_k=\phi_1^k\) for \(k=0, 1, 2, 3,...\)

Hence, for \(k=1\), the first partial autocorrelation coefficient is

\[\phi_{11}=\rho_1=\phi_1.\] From 19 for \(k=2\), the second partial
autocorrelation coefficient is

\[\phi_{22}=\frac{\rho_2-\rho_1^2}{1-\rho_1^2}=\frac{\phi_1^2-\phi_1^2}{1-\phi_1^2} = 0\].

Similarly, for \(AR(1)\) we can show that \(\phi_{kk}=0\) for all
\(k > 0\). Hence, for \(AR(1)\) process the partial autocorrelation is
non-zero for lag \(1\) which is the order of the process, but is zero
for lags beyond the order 1.

\subsection{PACF for AR(2) model}\label{pacf-for-ar2-model}

\textbf{Question 7:} For \(AR(2)\) process show that \(\phi_{kk}=0\) for
all \(k>2\). Sketch the PACF of \(AR(2)\) process.

\subsection{PACF for AR(P) model}\label{pacf-for-arp-model}

In general for \(AR(p)\) precess, the partial autocorrelation function
\(\phi_{kk}\) is non-zero for \(k\) less than or equal to \(p\) (the
order of the process) and zero for all \(k\) greater than \(p\). In
other words, the partial autocorrelation function of a \(AR(p)\) process
has a cut-off after lag \(p\).

\section{Moving average (MA) models}\label{moving-average-ma-models}

We first derive the properties of \(MA(1)\) and \(MA(2)\) models and
then give the results for the general \(MA(q)\) model.

\section{Properties of MA(1) model}\label{properties-of-ma1-model}

The general form for \(MA(1)\) model is

\begin{equation}
Y_t = \theta_0 + \theta_1 \epsilon_{t-1} + \epsilon_t
\end{equation}

where \(\theta_0\) is a constant and \({\epsilon_t}\) is a white noise
series.

\subsection{Mean}\label{mean-3}

\textbf{Question 8:} Show that \(E(Y_t) = \theta_0\).

\subsection{Variance}\label{variance-2}

\textbf{Question 9:} Show that \(Var(Y_t) = (1+\theta_1^2)\sigma^2\).

We can see both mean and variance are time-invariant. \(MA\) models are
finite linear combinations of a white noise sequence. Hence, \(MA\)
processes are always weakly stationary.

\subsection{Autocorrelation function of an MA(1)
process}\label{autocorrelation-function-of-an-ma1-process}

\subsubsection{Method 1}\label{method-1}

To obtain the autocorrelation function of \(MA(1)\), we first multiply
both sides of Equation 21 by \(Y_{t-k}\) and take the expectation.

\begin{equation}
\begin{aligned}
E[Y_tY_{t-k}] &= E[\theta_0 Y_{t-k} + \theta_1 \epsilon_{t-1} Y_{t-k} + \epsilon_t Y_{t-k}]\\
&= \theta_0 E(Y_{t-k}) + \theta_1 E(\epsilon_{t-1}Y_{t-k}) + E(\epsilon_t Y_{t-k})\\
\end{aligned}
\end{equation}

Using the independence between \(\epsilon_t\) and \(Y_{t-k}\) (future
error and past observation) \(E(\epsilon_t Y_{t-k}) = 0\). Now we have

\begin{equation}
E[Y_tY_{t-k}] = \theta_0^2  + \theta_1 E(\epsilon_{t-1}Y_{t-k}) 
\end{equation}

Now let's obtain an expression for \(E[Y_t Y_{t-k}]\).

\begin{equation}
\begin{aligned}
  \gamma_k &= Cov(Y_t, Y_{t-k}) \\
         &= E[(Y_t-\theta_0)(Y_{t-k}-\theta_0)] \\
         &= E[Y_tY_{t-k}-Y_t\theta_0-\theta_0 Y_{t-k} +\theta_0^2] \\
         &= E(Y_t Y_{t-k}) - \theta_0^2. \\
\end{aligned}
\end{equation}

Now we have

\begin{equation}
  E(Y_t Y_{t-k}) = \gamma_k + \theta_0^2.
\end{equation}

Using the Equations 23 and 25 we have

\begin{equation}
  \gamma_k = \theta_0^2 - \theta_0^2 + \theta_1E(\epsilon_{t-1}Y_{t-k}).
\end{equation}

Now let's consider the case \(k=1\).

\begin{equation}
  \gamma_1 = \theta_0^2 - \theta_0^2 + \theta_1E(\epsilon_{t-1}Y_{t-1})
\end{equation}

Today's error and today's value are dependent. Hence,
\(E(\epsilon_{t-1}Y_{t-1}) \neq 0.\) We first need to identify
\(E(\epsilon_{t-1}Y_{t-1})\).

\begin{equation}
\begin{aligned}
E(\epsilon_{t-1}Y_{t-1}) &= E(\theta_0 \epsilon_{t-1} + \theta_1 \epsilon_{t-2} \epsilon_{t-1}+ \epsilon_{t-1}^2)\\
\end{aligned}
\end{equation}

Since, \{\(\epsilon_t\)\} is a white noise process
\(E(\epsilon_{t-1}) = 0\) and \(E(\epsilon_{t-2} \epsilon_{t-1}) = 0\).
Hence, we have

\begin{equation}
\begin{aligned}
E(\epsilon_{t-1}Y_{t-1}) &= E(\epsilon_{t-1}^2)=\sigma^2\\
\end{aligned}
\end{equation}

Substituting \textbf{?@eq-covma5} in \textbf{?@eq-covma3} we get

\[\gamma_1=\theta_1\sigma^2\].

Furthermore, \(\gamma_0 = Var(Y_t)=  (1+\theta_1^2)\sigma^2\). Hence

\[\rho_1=\frac{\gamma_1}{\gamma_0}=\frac{\theta}{1+\theta_1^2}.\]

When \(k=2\), from Equation \textbf{?@eq-covma3} and
\(E(\epsilon_{t-1}Y_{k-2}) = 0\) (future error and past observation) we
get \(\gamma_2=0\). Hence \(\rho_2=0\). Similarly, we can show that

\[\gamma_k = \rho_k=0\] for all \(k \geq 2\).

We can see that the ACF of \(MA(1)\) process is zero, beyond the order
of 1 of the process.

\subsubsection{Method 2: By using the definition of
covariance}\label{method-2-by-using-the-definition-of-covariance}

\begin{equation}
\begin{aligned}
\gamma_1 = Cov(Y_t, Y_{t-1}) &= Cov(\epsilon_t + \theta_1 \epsilon_{t-1}+ \theta_0, \epsilon_{t-1}+\theta_1 \epsilon_{t-2} + \theta_0)\\
&=Cov(\theta_1 \epsilon_{t-1}, \epsilon_{t-1})\\
&=\theta_1 \sigma^2.
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\gamma_2=Cov(Y_t, Y_{t-2}) &= Cov(\epsilon_t + \theta_1 \epsilon_{t-1}+ \theta_0, \epsilon_{t-2}+\theta_1 \epsilon_{t-3} + \theta_0)\\
&=0.
\end{aligned}
\end{equation}

We have \(\gamma_0=\sigma^2(1+\theta_1^2)\), (Using the variance).

Hence

\[\rho_1=\frac{\gamma_1}{\gamma_0}=\frac{\theta_1}{1+\theta_1^2}.\]

Similarly we can show \(\gamma_k=\rho_k=0\) for all \(k \geq 2\).

\section{Properties of MA(2) model}\label{properties-of-ma2-model}

An \(MA(2)\) model is in the form

\begin{equation}
Y_t = \theta_0 + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \epsilon_t
\end{equation}

where \(\theta_0\) is a constant and \({\epsilon_t}\) is a white noise
series.

\subsection{Mean}\label{mean-4}

\textbf{Question 10: } Show that \(E(Y_t) = \theta_0.\)

\subsection{Variance}\label{variance-3}

\textbf{Question 11: } Show that
\(Var(Y_t) = \sigma^2 (1+\theta_1^2 + \theta_2^2).\)

\subsection{Autocorrelation function of an MA(2)
process}\label{autocorrelation-function-of-an-ma2-process}

\textbf{Question 12: }For \(MA(2)\) process show that,

\[\rho_1=\frac{\theta_1(1+\theta_2)}{1+\theta_1^2+\theta_2^2},\]
\[\rho_2 = \frac{\theta_2}{1+\theta_1^2 + \theta_2^2},\]

and \(\rho_k=0\) for all \(k \geq 3.\)

\section{Properties of MA(q) model}\label{properties-of-maq-model}

\begin{equation}
Y_t = \theta_0 + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} +...+ \theta_q \epsilon_{t-q} +\epsilon_t
\end{equation}

where \(\theta_0\) is a constant and \({\epsilon_t}\) is a white noise
series.

\subsection{Mean}\label{mean-5}

\textbf{Question 13:} Show that the constant term of an \(MA\) model is
the mean of the series (i.e.~\(E(Y_t)=\theta_0\)).

\subsection{Variance}\label{variance-4}

\textbf{Question 14:} Show that the variance of an \(MA\) model is
\[Var(Y_t)=(1+\theta_1^2+\theta_2^2+...+\theta_q^2)\sigma^2.\]

\subsection{Autocorrelation function of an MA(q)
process}\label{autocorrelation-function-of-an-maq-process}

\textbf{Question 15:} Show that the autocorrelation function of a
\(MA(q)\) process is zero, beyond the order of \(q\) of the process. In
other words, the autocorrelation function of a moving average process
has a cutoff after lag \(q\).

\section{Partial autocorrelation function of an MA(q)
process}\label{partial-autocorrelation-function-of-an-maq-process}

The partial autocorrelation functions for \(MA(q)\) models behave very
much like the autocorrelation functions of \(AR(p)\) models. The PACF of
\(MA\) models decays exponentially to zero, rather like ACF for \(AR\)
model.

\section{Dual relation between AR and MA
process}\label{dual-relation-between-ar-and-ma-process}

\textbf{Dual relation 1}

\textbf{First we consider the relation AR(p) \textless--\textgreater{}
MA(}\(\infty\)\textbf{)}

Let \(AR(p)\) be a \textbf{stationary} \(AR\) model with order \(p\).
Then,

\[Y_t = \phi_1Y_{t-1}+ \phi_2Y_{t-2}+...+ \phi_pY_{t-p}+\epsilon_t,\]
where \(\epsilon_t \sim WN(0, \sigma^2).\)

Using the backshift operator we can write the \(AR(p)\) model as

\[(1-\phi_1B-\phi_2B^2-...-\phi_pB^P)Y_t=\epsilon_t.\] Then

\[\phi(B)Y_t=\epsilon_t,\] where
\(\phi(B)=1-\phi_1B-\phi_2B^2-...-\phi_pB^p.\) Furthermore, \(Y_t\) can
be written as infinite sum of previous \(\epsilon\)'s as below

\[Y_t = \phi^{-1}(B)\epsilon_t,\] where \(\phi(B)\psi(B)=1\) and
\(\psi(B)=1+\Psi_1B+\psi_2B^2+...\) Then \[Y_t=\psi(B)\epsilon_t.\] This
is a representation of \(MA(\infty)\) process.

\textbf{Next, we consider the relation MA(q) \textless--\textgreater{}
AR(}\(\infty\)\textbf{)}

Let \(MA(q)\) be \textbf{invertible} moving average process

\[Y_t = \epsilon_t + \theta_t\epsilon_{t-1}+\theta_2\epsilon_{t-2}+...+\theta_p\epsilon_{t-q}.\]

Using the backshift operator we can write the \(MA(q)\) process as

\[Y_t = (1+\theta_1B+\theta_2B^2-...+\theta_qB^q)\epsilon_t.\]

Then,

\[Y_t = \theta(B)\epsilon_t,\]

where \(\theta(B)=1+\theta_1B+\theta_2B^2+...+\theta_1B^q.\) Hence, for
an \textbf{invertible} moving average process, \(Y_t\) can be
represented as a finite weighted sum of previous error terms,
\(\epsilon\). Furthermore, since the process is invertible
\(\epsilon_t\) can be represented as an infinite weighted sum of
previous \(Y\)'s as below

\[\epsilon_t=\theta^{-1}(B)Y_t,\] where \(\pi(B)\theta(B)=1\), and
\(\pi(B) = 1+\pi_1B+\pi B^2+...\). Hence,

\[\epsilon_t = \pi(B)Y_t.\] This is an representation of a
\(AR(\infty)\) process.

\textbf{Dual relation 2}

An \(MA(q)\) process has an ACF function that is zero beyond lag \(q\)
and its PACF is decays exponentially to 0. Consequently, an \(AR(p)\)
process has an PACF that is zero beyond lag-\(p\), but its ACF decays
exponentially to 0.

\textbf{Dual relation 3}

For an \(AR(p)\) process the roots of \(\phi(B)=0\) must lie outside the
unit circle to satisfy the condition of stationarity. However, the
parameters of the \(AR(p)\) are not required to satisfy any conditions
to ensure invertibility. Conversely, the parameters of the \(MA\)
process are not required to satisfy any condition to ensure
stationarity. However, to ensure the condition of invertibility, the
roots of \(\theta(B)=0\) must lie outside the unit circle.

\section{Autoregressive and Moving-average (ARMA)
models}\label{autoregressive-and-moving-average-arma-models}

current value = linear combination of past values + linear combination
of past error + current error

The \(ARMA(p, q)\) can be written as

\[Y_t=c+\phi_1 Y_{t-1}+\phi_2 Y_{t-2}+...+\phi_p Y_{t-p}+\theta_1\epsilon_{t-1}+\theta_2\epsilon_{t-2}+...+\theta_q\epsilon_{t-q}+\epsilon_t,\]
where \(\{\epsilon_t\}\) is a white noise process.

Using the back shift operator

\[\phi(B)Y_t=\theta(B)\epsilon_t,\] where \(\phi(.)\) and \(\theta(.)\)
are the \(p\)th and \(q\)th degree polynomials,

\[\phi(B)=1-\phi_1 \epsilon -...-\phi_p \epsilon^p,\] and
\[\theta(B)=1+\theta_1\epsilon+...+\theta_q\epsilon^q.\]

\section{Stationary condition}\label{stationary-condition}

Roots of \[\phi(B)=0\] lie outside the unit circle.

\section{Invertible condition}\label{invertible-condition}

Roots of \[\theta(B)=0\] lie outside the unit circle.

\section{Autocorrelation function and Partial autocorrelation
function}\label{autocorrelation-function-and-partial-autocorrelation-function}

The ACF of an ARMA model exhibits a pattern similar to that of an AR
model. The PACF of ARMA process behaves like the PACF of a MA process.
Hence, the ACF and PACF are not informative in determining the order of
an ARMA model.

\section{Theoretical ACF and PACF for AR, MA and ARMA
models}\label{theoretical-acf-and-pacf-for-ar-ma-and-arma-models}

Theoretical autocorrelation coefficients for some of the more common AR,
MA and ARMA models are shown here. However, the ACF and PACF calculated
from the data will not exactly match any set of theoretical ACF and PACF
because the ACF and PACF calculated from the data are subject to
sampling variation.

\section{ACF and PACF calculated from
data}\label{acf-and-pacf-calculated-from-data}

\begin{figure}[H]

{\centering \pandocbounded{\includegraphics[keepaspectratio]{04-chap4_files/figure-pdf/unnamed-chunk-1-1.pdf}}

}

\caption{ACF and PACF of AR(1), MA(1) and ARMA(1, 1) models calculated
from the data}

\end{figure}%

\section{References}\label{references}

Box, G. E., Jenkins, G. M., Reinsel, G. C., \& Ljung, G. M. (2015). Time
series analysis: forecasting and control.

\bookmarksetup{startatroot}

\chapter{Fit ARIMA class models using R/
Python}\label{fit-arima-class-models-using-r-python}

\bookmarksetup{startatroot}

\chapter{Spatial Data Visualisation}\label{spatial-data-visualisation}

\section{R packages for spatial data
analysis}\label{r-packages-for-spatial-data-analysis}

\begin{itemize}
\item
  rgdal
\item
  sp
\item
  rgeos
\item
  raster
\item
  sf
\item
  tmap
\item
  leaflet
\item
  ggmap
\item
  maptools
\item
  gstat
\item
  spatstat
\item
  stars
\item
  geosphere
\item
  RgoogleMaps
\item
  rasterVis
\end{itemize}

\section{Geospatial vector data
structures}\label{geospatial-vector-data-structures}

\begin{itemize}
\item
  Point: Individual longitude and latitude of locations

  Eg: Locations, Buildings
\item
  Lines: Two or more vertices or points that are connected

  Eg: Roads, rivers
\item
  Polygons: Three or more vertices and closed

  Eg: Area of a country, state, district
\end{itemize}

\section{Challenge in Spatial Data
Viualisation}\label{challenge-in-spatial-data-viualisation}

Move from

\pandocbounded{\includegraphics[keepaspectratio]{index_files/mediabag/globe-world.gif}}

to

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-1-1.pdf}}

How to transform this three dimensional angular system to a two
dimensional cartesian system?

Solution: Spatial Projections

\section{Map Projection}\label{map-projection}

\begin{itemize}
\item
  A projection is about the geometric transformation from 3D to 2D.
\item
  A map projection is a method or mathematical formula to represent the
  curved surface of the Earth on a flat map.
\item
  It focuses on how the Earth's surface is ``flattened'', which always
  introduces some distortion in area, shape, distance, or direction.
\end{itemize}

Examples:

Mercator (preserves direction)

Albers Equal-Area Conic (preserves area)

Goode Homolosine (minimizes distortion globally)

\section{Types of Map Projections}\label{types-of-map-projections}

\subsection{Cylindrical Projections}\label{cylindrical-projections}

Imagine wrapping a cylinder around the Earth and projecting the surface
onto it.

Characteristics:

Meridians and parallels are straight and perpendicular.

Distortion increases away from the equator.

Example:

Mercator Projection -- preserves direction, but greatly distorts area
near the poles.

\subsection{Conical Projections}\label{conical-projections}

Imagine wrapping a cone over the Earth, usually touching at one or two
standard parallels.

Characteristics:

Parallels appear as arcs; meridians converge toward a point.

Best for mid-latitude regions with an east--west extent.

Example:

Albers Equal-Area Conic -- preserves area, commonly used for countries
or regions.

\subsection{Planar (Azimuthal)
Projections}\label{planar-azimuthal-projections}

The Earth's surface is projected onto a flat plane, usually touching at
a single point.

Characteristics:

Distortion increases outward from the point of tangency.

Can preserve distance, area, or shape depending on the type.

Example:

Goode Homolosine -- minimizes global distortion by combining multiple
projection methods.

Visit
\href{https://johnedevans.files.wordpress.com/2019/01/map-projections-explained.jpg}{here}
to see the visual illustration.

\section{Example maps}\label{example-maps}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-4-1.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-4-2.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-4-3.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-4-4.pdf}}

\section{Why Multiple Map Projection Types
Exist}\label{why-multiple-map-projection-types-exist}

The Earth is round, but maps are flat. Because no flat map can perfectly
preserve all properties of the globe, every projection introduces some
distortion. Different projections are therefore designed to preserve
certain properties depending on the map's purpose.

\subsection{Key Reasons for Multiple Projection
Types}\label{key-reasons-for-multiple-projection-types}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Different Types of Distortion
\end{enumerate}

Shape (conformal) -- keeps angles and shapes correct (e.g., Mercator).

Area (equal-area / equivalent) -- keeps relative sizes correct (e.g.,
Albers Equal-Area Conic).

Distance (equidistant) -- preserves distances from a point or along
certain lines (e.g., Azimuthal Equidistant).

Direction (azimuthal / navigational) -- preserves angles and compass
bearings (e.g., Mercator for navigation).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Geographical Focus
\end{enumerate}

Some projections are better for global maps, others for regional or
local maps.

Example: Conical projections work well for mid-latitude countries, while
planar projections work for polar regions.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Practical Applications
\end{enumerate}

Navigation -- need accurate direction ‚Üí Mercator.

Thematic / statistical maps -- need accurate area ‚Üí Albers Equal-Area.

Minimizing overall distortion -- Goode Homolosine for global thematic
maps.

\section{Quick Comparison Table}\label{quick-comparison-table}

In-class

\section{Coordinate Reference System
(CRS)}\label{coordinate-reference-system-crs}

A CRS is a complete spatial reference framework that defines:

\begin{itemize}
\item
  How coordinates relate to the Earth (datum)

  A datum defines the mathematical Earth model and reference point for
  coordinates, ensuring that latitude, longitude, and height correspond
  to real positions on the Earth.)
\item
  The map projection used (if any)
\end{itemize}

\section{What is a Datum?}\label{what-is-a-datum}

A datum is a mathematical model of the Earth that defines:

The size and shape of the Earth (ellipsoid or spheroid)

The origin and orientation of the coordinate system (where latitude 0¬∞,
longitude 0¬∞ are defined)

In short, a datum tells us where ``zero'' is and how the coordinates are
measured on the Earth's surface.

\section{Why is a Datum Important?}\label{why-is-a-datum-important}

Different datums model the Earth slightly differently, so the same
latitude/longitude may correspond to different locations depending on
the datum.

Example:

WGS84 ‚Üí used by GPS

NAD83 ‚Üí used in North America

A coordinate of 40¬∞N, 75¬∞W will be slightly different on WGS84 vs NAD83
because the reference ellipsoid is slightly shifted.

\section{Projection vs CRS}\label{projection-vs-crs}

\begin{itemize}
\item
  Projection = method to flatten the Earth
\item
  CRS = full system that defines the Earth model + projection +
  coordinate rules
\end{itemize}

\section{Shapefile}\label{shapefile}

A shapefile is a popular geospatial vector data format used to store
geographic features like points, lines, and polygons, along with their
attributes. It's commonly used in GIS (Geographic Information Systems)
and mapping software, including R (sf or rgdal packages).

A shapefile actually consists of several files that work together. The
main ones are:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 2\tabcolsep) * \real{0.6400}}
  >{\raggedright\arraybackslash}p{(\linewidth - 2\tabcolsep) * \real{0.3600}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
File Extension
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Purpose
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
.shp & Geometry of features (points, lines, polygons) \\
.shx & Shape index (helps software find features quickly) \\
.dbf & Attribute data (like a spreadsheet) \\
.prj & Projection information (coordinate reference system) \\
.cpg & Encoding of text attributes (optional) \\
\end{longtable}

\section{R Example 1}\label{r-example-1}

\begin{verbatim}
Simple feature collection with 6 features and 168 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -73.36621 ymin: -22.40205 xmax: 109.4449 ymax: 41.9062
Geodetic CRS:  WGS 84
       featurecla scalerank labelrank sovereignt sov_a3 adm0_dif level
1 Admin-0 country         1         3   Zimbabwe    ZWE        0     2
2 Admin-0 country         1         3     Zambia    ZMB        0     2
3 Admin-0 country         1         3      Yemen    YEM        0     2
4 Admin-0 country         3         2    Vietnam    VNM        0     2
5 Admin-0 country         5         3  Venezuela    VEN        0     2
6 Admin-0 country         6         6    Vatican    VAT        0     2
               type tlc     admin adm0_a3 geou_dif   geounit gu_a3 su_dif
1 Sovereign country   1  Zimbabwe     ZWE        0  Zimbabwe   ZWE      0
2 Sovereign country   1    Zambia     ZMB        0    Zambia   ZMB      0
3 Sovereign country   1     Yemen     YEM        0     Yemen   YEM      0
4 Sovereign country   1   Vietnam     VNM        0   Vietnam   VNM      0
5 Sovereign country   1 Venezuela     VEN        0 Venezuela   VEN      0
6 Sovereign country   1   Vatican     VAT        0   Vatican   VAT      0
    subunit su_a3 brk_diff      name name_long brk_a3  brk_name brk_group
1  Zimbabwe   ZWE        0  Zimbabwe  Zimbabwe    ZWE  Zimbabwe      <NA>
2    Zambia   ZMB        0    Zambia    Zambia    ZMB    Zambia      <NA>
3     Yemen   YEM        0     Yemen     Yemen    YEM     Yemen      <NA>
4   Vietnam   VNM        0   Vietnam   Vietnam    VNM   Vietnam      <NA>
5 Venezuela   VEN        0 Venezuela Venezuela    VEN Venezuela      <NA>
6   Vatican   VAT        0   Vatican   Vatican    VAT   Vatican      <NA>
  abbrev postal                        formal_en
1  Zimb.     ZW             Republic of Zimbabwe
2 Zambia     ZM               Republic of Zambia
3   Yem.     YE                Republic of Yemen
4  Viet.     VN    Socialist Republic of Vietnam
5   Ven.     VE Bolivarian Republic of Venezuela
6   Vat.      V        State of the Vatican City
                           formal_fr              name_ciawf note_adm0 note_brk
1                               <NA>                Zimbabwe      <NA>     <NA>
2                               <NA>                  Zambia      <NA>     <NA>
3                               <NA>                   Yemen      <NA>     <NA>
4                               <NA>                 Vietnam      <NA>     <NA>
5 Rep√∫blica Bolivariana de Venezuela               Venezuela      <NA>     <NA>
6                               <NA> Holy See (Vatican City)      <NA>     <NA>
           name_sort name_alt mapcolor7 mapcolor8 mapcolor9 mapcolor13  pop_est
1           Zimbabwe     <NA>         1         5         3          9 14645468
2             Zambia     <NA>         5         8         5         13 17861030
3        Yemen, Rep.     <NA>         5         3         3         11 29161922
4            Vietnam     <NA>         5         6         5          4 96462106
5      Venezuela, RB     <NA>         1         3         1          4 28515829
6 Vatican (Holy See) Holy See         1         3         4          2      825
  pop_rank pop_year gdp_md gdp_year                    economy
1       14     2019  21440     2019    5. Emerging region: G20
2       14     2019  23309     2019  7. Least developed region
3       15     2019  22581     2019  7. Least developed region
4       16     2019 261921     2019    5. Emerging region: G20
5       15     2019 482359     2014    5. Emerging region: G20
6        2     2019    -99     2019 2. Developed region: nonG7
               income_grp fips_10 iso_a2 iso_a2_eh iso_a3 iso_a3_eh iso_n3
1           5. Low income      ZI     ZW        ZW    ZWE       ZWE    716
2  4. Lower middle income      ZA     ZM        ZM    ZMB       ZMB    894
3  4. Lower middle income      YM     YE        YE    YEM       YEM    887
4  4. Lower middle income      VM     VN        VN    VNM       VNM    704
5  3. Upper middle income      VE     VE        VE    VEN       VEN    862
6 2. High income: nonOECD      VT     VA        VA    VAT       VAT    336
  iso_n3_eh un_a3 wb_a2 wb_a3   woe_id woe_id_eh                   woe_note
1       716   716    ZW   ZWE 23425004  23425004 Exact WOE match as country
2       894   894    ZM   ZMB 23425003  23425003 Exact WOE match as country
3       887   887    RY   YEM 23425002  23425002 Exact WOE match as country
4       704   704    VN   VNM 23424984  23424984 Exact WOE match as country
5       862   862    VE   VEN 23424982  23424982 Exact WOE match as country
6       336   336   -99   -99 23424986  23424986 Exact WOE match as country
  adm0_iso adm0_diff adm0_tlc adm0_a3_us adm0_a3_fr adm0_a3_ru adm0_a3_es
1      ZWE      <NA>      ZWE        ZWE        ZWE        ZWE        ZWE
2      ZMB      <NA>      ZMB        ZMB        ZMB        ZMB        ZMB
3      YEM      <NA>      YEM        YEM        YEM        YEM        YEM
4      VNM      <NA>      VNM        VNM        VNM        VNM        VNM
5      VEN      <NA>      VEN        VEN        VEN        VEN        VEN
6      VAT      <NA>      VAT        VAT        VAT        VAT        VAT
  adm0_a3_cn adm0_a3_tw adm0_a3_in adm0_a3_np adm0_a3_pk adm0_a3_de adm0_a3_gb
1        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE
2        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB
3        YEM        YEM        YEM        YEM        YEM        YEM        YEM
4        VNM        VNM        VNM        VNM        VNM        VNM        VNM
5        VEN        VEN        VEN        VEN        VEN        VEN        VEN
6        VAT        VAT        VAT        VAT        VAT        VAT        VAT
  adm0_a3_br adm0_a3_il adm0_a3_ps adm0_a3_sa adm0_a3_eg adm0_a3_ma adm0_a3_pt
1        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE
2        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB
3        YEM        YEM        YEM        YEM        YEM        YEM        YEM
4        VNM        VNM        VNM        VNM        VNM        VNM        VNM
5        VEN        VEN        VEN        VEN        VEN        VEN        VEN
6        VAT        VAT        VAT        VAT        VAT        VAT        VAT
  adm0_a3_ar adm0_a3_jp adm0_a3_ko adm0_a3_vn adm0_a3_tr adm0_a3_id adm0_a3_pl
1        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE
2        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB
3        YEM        YEM        YEM        YEM        YEM        YEM        YEM
4        VNM        VNM        VNM        VNM        VNM        VNM        VNM
5        VEN        VEN        VEN        VEN        VEN        VEN        VEN
6        VAT        VAT        VAT        VAT        VAT        VAT        VAT
  adm0_a3_gr adm0_a3_it adm0_a3_nl adm0_a3_se adm0_a3_bd adm0_a3_ua adm0_a3_un
1        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        -99
2        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        -99
3        YEM        YEM        YEM        YEM        YEM        YEM        -99
4        VNM        VNM        VNM        VNM        VNM        VNM        -99
5        VEN        VEN        VEN        VEN        VEN        VEN        -99
6        VAT        VAT        VAT        VAT        VAT        VAT        -99
  adm0_a3_wb     continent region_un          subregion
1        -99        Africa    Africa     Eastern Africa
2        -99        Africa    Africa     Eastern Africa
3        -99          Asia      Asia       Western Asia
4        -99          Asia      Asia South-Eastern Asia
5        -99 South America  Americas      South America
6        -99        Europe    Europe    Southern Europe
                   region_wb name_len long_len abbrev_len tiny homepart
1         Sub-Saharan Africa        8        8          5  -99        1
2         Sub-Saharan Africa        6        6          6  -99        1
3 Middle East & North Africa        5        5          4  -99        1
4        East Asia & Pacific        7        7          5    2        1
5  Latin America & Caribbean        9        9          4  -99        1
6      Europe & Central Asia        7        7          4    4        1
  min_zoom min_label max_label   label_x    label_y      ne_id wikidataid
1        0       2.5       8.0  29.92544 -18.911640 1159321441       Q954
2        0       3.0       8.0  26.39530 -14.660804 1159321439       Q953
3        0       3.0       8.0  45.87438  15.328226 1159321425       Q805
4        0       2.0       7.0 105.38729  21.715416 1159321417       Q881
5        0       2.5       7.5 -64.59938   7.182476 1159321411       Q717
6        0       5.0      10.0  12.45342  41.903323 1159321407       Q237
    name_ar       name_bn      name_de      name_en             name_es
1  ÿ≤ŸäŸÖÿ®ÿßÿ®ŸàŸä      ‡¶ú‡¶ø‡¶Æ‡ßç‡¶¨‡¶æ‡¶¨‡ßÅ‡¶Ø‡¶º‡ßá     Simbabwe     Zimbabwe            Zimbabue
2    ÿ≤ÿßŸÖÿ®Ÿäÿß       ‡¶ú‡¶æ‡¶Æ‡ßç‡¶¨‡¶ø‡¶Ø‡¶º‡¶æ       Sambia       Zambia              Zambia
3     ÿßŸÑŸäŸÖŸÜ        ‡¶á‡¶Ø‡¶º‡ßá‡¶Æ‡ßá‡¶®        Jemen        Yemen               Yemen
4    ŸÅŸäÿ™ŸÜÿßŸÖ      ‡¶≠‡¶ø‡¶Ø‡¶º‡ßá‡¶§‡¶®‡¶æ‡¶Æ      Vietnam      Vietnam             Vietnam
5   ŸÅŸÜÿ≤ŸàŸäŸÑÿß     ‡¶≠‡ßá‡¶®‡ßá‡¶ú‡ßÅ‡¶Ø‡¶º‡ßá‡¶≤‡¶æ    Venezuela    Venezuela           Venezuela
6 ÿßŸÑŸÅÿßÿ™ŸäŸÉÿßŸÜ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø‡¶ï‡¶æ‡¶® ‡¶∏‡¶ø‡¶ü‡¶ø Vatikanstadt Vatican City Ciudad del Vaticano
   name_fa         name_fr    name_el       name_he   name_hi   name_hu
1 ÿ≤€åŸÖÿ®ÿßÿ®ŸàŸá        Zimbabwe ŒñŒπŒºœÄŒ¨ŒºœÄŒøœÖŒµ      ◊ñ◊ô◊û◊ë◊ë◊ï◊ê◊î   ‡§ú‡§º‡§ø‡§Æ‡•ç‡§¨‡§æ‡§¨‡•ç‡§µ‡•á  Zimbabwe
2   ÿ≤ÿßŸÖÿ®€åÿß          Zambie     ŒñŒ¨ŒºœÄŒπŒ±         ◊ñ◊û◊ë◊ô◊î   ‡§ú‡§º‡§æ‡§Æ‡•ç‡§¨‡§ø‡§Ø‡§æ    Zambia
3      €åŸÖŸÜ           Y√©men     Œ•ŒµŒºŒ≠ŒΩŒ∑          ◊™◊ô◊û◊ü       ‡§Ø‡§Æ‡§®     Jemen
4   Ÿà€åÿ™ŸÜÿßŸÖ        Vi√™t Nam    ŒíŒπŒµœÑŒΩŒ¨Œº       ◊ï◊ô◊ô◊ò◊†◊ê◊ù   ‡§µ‡§ø‡§Ø‡§§‡§®‡§æ‡§Æ   Vietn√°m
5  ŸàŸÜÿ≤Ÿàÿ¶ŸÑÿß       Venezuela ŒíŒµŒΩŒµŒ∂ŒøœÖŒ≠ŒªŒ±       ◊ï◊†◊¶◊ï◊ê◊ú◊î    ‡§µ‡•á‡§®‡•á‡§ú‡§º‡•Å‡§è‡§≤‡§æ Venezuela
6  Ÿàÿßÿ™€å⁄©ÿßŸÜ Cit√© du Vatican   ŒíŒ±œÑŒπŒ∫Œ±ŒΩœå ◊ß◊®◊ô◊ô◊™ ◊î◊ï◊ï◊™◊ô◊ß◊ü ‡§µ‡•à‡§ü‡§ø‡§ï‡§® ‡§®‡§ó‡§∞   Vatik√°n
    name_id            name_it    name_ja     name_ko      name_nl   name_pl
1  Zimbabwe           Zimbabwe „Ç∏„É≥„Éê„Éñ„Ç®    ÏßêÎ∞îÎ∏åÏõ®     Zimbabwe  Zimbabwe
2    Zambia             Zambia   „Ç∂„É≥„Éì„Ç¢      Ïû†ÎπÑÏïÑ       Zambia    Zambia
3     Yaman              Yemen   „Ç§„Ç®„É°„É≥        ÏòàÎ©ò        Jemen     Jemen
4   Vietnam            Vietnam   „Éô„Éà„Éä„É†      Î≤†Ìä∏ÎÇ®      Vietnam   Wietnam
5 Venezuela          Venezuela „Éô„Éç„Ç∫„Ç®„É©  Î≤†ÎÑ§ÏàòÏóòÎùº    Venezuela Wenezuela
6   Vatikan Citt√† del Vaticano   „Éê„ÉÅ„Ç´„É≥ Î∞îÌã∞Ïπ∏ ÏãúÍµ≠ Vaticaanstad   Watykan
    name_pt   name_ru       name_sv   name_tr   name_uk    name_ur
1  Zimb√°bue  –ó–∏–º–±–∞–±–≤–µ      Zimbabwe  Zimbabve  –ó—ñ–º–±–∞–±–≤–µ    ÿ≤ŸÖÿ®ÿßÿ®Ÿà€í
2    Z√¢mbia    –ó–∞–º–±–∏—è        Zambia   Zambiya    –ó–∞–º–±—ñ—è     ÿ≤€åŸÖÿ®€åÿß
3     I√©men     –ô–µ–º–µ–Ω         Jemen     Yemen      –Ñ–º–µ–Ω        €åŸÖŸÜ
4  Vietname   –í—å–µ—Ç–Ω–∞–º       Vietnam   Vietnam   –í'—î—Ç–Ω–∞–º     Ÿà€åÿ™ŸÜÿßŸÖ
5 Venezuela –í–µ–Ω–µ—Å—É—ç–ª–∞     Venezuela Venezuela –í–µ–Ω–µ—Å—É–µ–ª–∞  Ÿà€åŸÜ€åÿ≤Ÿà€åŸÑÿß
6  Vaticano   –í–∞—Ç–∏–∫–∞–Ω Vatikanstaten   Vatikan   –í–∞—Ç–∏–∫–∞–Ω Ÿà€åŸπ€å⁄©ŸÜ ÿ≥Ÿπ€å
        name_vi  name_zh name_zht      fclass_iso tlc_diff      fclass_tlc
1      Zimbabwe Ê¥•Â∑¥Â∏ÉÈü¶   ËæõÂ∑¥Â®Å Admin-0 country     <NA> Admin-0 country
2        Zambia   ËµûÊØî‰∫ö   Â∞öÊØî‰∫û Admin-0 country     <NA> Admin-0 country
3         Yemen     ‰πüÈó®     ËëâÈñÄ Admin-0 country     <NA> Admin-0 country
4      Vi·ªát Nam     Ë∂äÂçó     Ë∂äÂçó Admin-0 country     <NA> Admin-0 country
5     Venezuela ÂßîÂÜÖÁëûÊãâ ÂßîÂÖßÁëûÊãâ Admin-0 country     <NA> Admin-0 country
6 Th√†nh Vatican   Ê¢µËíÇÂÜà   Ê¢µËíÇÂ≤° Admin-0 country     <NA> Admin-0 country
  fclass_us fclass_fr fclass_ru fclass_es fclass_cn fclass_tw fclass_in
1      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
2      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
3      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
4      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
5      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
6      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
  fclass_np fclass_pk fclass_de fclass_gb fclass_br fclass_il fclass_ps
1      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
2      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
3      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
4      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
5      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
6      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
  fclass_sa fclass_eg fclass_ma fclass_pt fclass_ar fclass_jp fclass_ko
1      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
2      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
3      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
4      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
5      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
6      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
  fclass_vn fclass_tr fclass_id fclass_pl fclass_gr fclass_it fclass_nl
1      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
2      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
3      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
4      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
5      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
6      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
  fclass_se fclass_bd fclass_ua                       geometry
1      <NA>      <NA>      <NA> MULTIPOLYGON (((31.28789 -2...
2      <NA>      <NA>      <NA> MULTIPOLYGON (((30.39609 -1...
3      <NA>      <NA>      <NA> MULTIPOLYGON (((53.08564 16...
4      <NA>      <NA>      <NA> MULTIPOLYGON (((104.064 10....
5      <NA>      <NA>      <NA> MULTIPOLYGON (((-60.82119 9...
6      <NA>      <NA>      <NA> MULTIPOLYGON (((12.43916 41...
\end{verbatim}

\begin{verbatim}
Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]
\end{verbatim}

\section{R Example 2}\label{r-example-2}

\begin{verbatim}
[1] "sf"         "tbl_df"     "tbl"        "data.frame"
\end{verbatim}

\begin{verbatim}
Simple feature collection with 1 feature and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 362203.3 ymin: 380301.9 xmax: 621918.1 ymax: 813560.9
Projected CRS: SLD99 / Sri Lanka Grid 1999
# A tibble: 1 x 2
                                                                geometry COUNTRY
                                                      <MULTIPOLYGON [m]> <chr>  
1 (((481925.5 381353.7, 481922.9 381350.3, 481919 381348.2, 481914.6 38~ SRI LA~
\end{verbatim}

or

\begin{verbatim}
Coordinate Reference System:
  User input: EPSG:5235 
  wkt:
PROJCRS["SLD99 / Sri Lanka Grid 1999",
    BASEGEOGCRS["SLD99",
        DATUM["Sri Lanka Datum 1999",
            ELLIPSOID["Everest 1830 (1937 Adjustment)",6377276.345,300.8017,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",5233]],
    CONVERSION["Sri Lanka Grid 1999",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",7.00047152777778,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",80.7717130833333,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9999238418,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["unknown"],
        AREA["Sri Lanka - onshore"],
        BBOX[5.86,79.64,9.88,81.95]],
    ID["EPSG",5235]]
\end{verbatim}

Visualizing using shapefiles: map of Sri Lanka

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-11-1.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-12-1.pdf}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
geometry & COUNTRY \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
MULTIPOLYGON (((481925.5 38\ldots{} & SRI LANKA \\
\end{longtable}

\section{Exercise}\label{exercise-1}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Draw district and province maps
\end{enumerate}

data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{province}
\NormalTok{district}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Guess the output.
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Colour provinces according to the population.
\end{enumerate}

\section{Annotations}\label{annotations}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-16-1.pdf}}

\section{Spatial Data Wrangling}\label{spatial-data-wrangling}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Convert regular data frame to sf
\end{enumerate}

\begin{verbatim}
Coordinate Reference System:
  User input: EPSG:4326 
  wkt:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        MEMBER["World Geodetic System 1984 (G2296)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Transforming coordinates
\end{enumerate}

\begin{verbatim}
Coordinate Reference System:
  User input: EPSG:32618 
  wkt:
PROJCRS["WGS 84 / UTM zone 18N",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            MEMBER["World Geodetic System 1984 (G2296)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 18N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",-75,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Navigation and medium accuracy spatial referencing."],
        AREA["Between 78¬∞W and 72¬∞W, northern hemisphere between equator and 84¬∞N, onshore and offshore. Bahamas. Canada - Nunavut; Ontario; Quebec. Colombia. Cuba. Ecuador. Greenland. Haiti. Jamaica. Panama. Turks and Caicos Islands. United States (USA). Venezuela."],
        BBOX[0,-78,84,-72]],
    ID["EPSG",32618]]
\end{verbatim}

\begin{verbatim}
Simple feature collection with 3 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -74.006 ymin: 35.6895 xmax: 139.6917 ymax: 51.5074
Geodetic CRS:  WGS 84
      name                 geometry
1 New York  POINT (-74.006 40.7128)
2   London  POINT (-0.1276 51.5074)
3    Tokyo POINT (139.6917 35.6895)
\end{verbatim}

\begin{verbatim}
Simple feature collection with 3 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -2693059 ymin: 4507351 xmax: 4935636 ymax: 15438700
Projected CRS: WGS 84 / UTM zone 18N
      name                  geometry
1 New York  POINT (583959.4 4507351)
2   London   POINT (4935636 8691571)
3    Tokyo POINT (-2693059 15438701)
\end{verbatim}

\section{Two types of maps}\label{two-types-of-maps}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Simple feature map
\item
  Polygon maps
\end{enumerate}

\section{Simple feature map}\label{simple-feature-map}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-21-1.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-22-1.pdf}}

\section{Polygon map}\label{polygon-map}

Example 1

\begin{verbatim}
Simple feature collection with 1 feature and 0 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 0 ymin: 0 xmax: 1 ymax: 1
CRS:           NA
                        geometry
1 POLYGON ((0 0, 0 1, 1 1, 1 ...
\end{verbatim}

\begin{verbatim}
     X Y L1 L2
[1,] 0 0  1  1
[2,] 0 1  1  1
[3,] 1 1  1  1
[4,] 1 0  1  1
[5,] 0 0  1  1
\end{verbatim}

\begin{verbatim}
  X Y L1 L2
1 0 0  1  1
2 0 1  1  1
3 1 1  1  1
4 1 0  1  1
5 0 0  1  1
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-23-1.pdf}}

\begin{verbatim}
Simple feature collection with 1 feature and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 362203.3 ymin: 380301.9 xmax: 621918.1 ymax: 813560.9
Projected CRS: SLD99 / Sri Lanka Grid 1999
# A tibble: 1 x 2
                                                                geometry COUNTRY
                                                      <MULTIPOLYGON [m]> <chr>  
1 (((481925.5 381353.7, 481922.9 381350.3, 481919 381348.2, 481914.6 38~ SRI LA~
\end{verbatim}

\begin{verbatim}
                        geometry   COUNTRY
1 MULTIPOLYGON (((481925.5 38... SRI LANKA
\end{verbatim}

Example 2

\begin{verbatim}
# A tibble: 6 x 4
  fips  abbr  state_name pop_2022
  <chr> <chr> <chr>         <dbl>
1 01    AL    Alabama     5074296
2 02    AK    Alaska       733583
3 04    AZ    Arizona     7359197
4 05    AR    Arkansas    3045637
5 06    CA    California 39029342
6 08    CO    Colorado    5839926
\end{verbatim}

\begin{verbatim}
# A tibble: 6 x 12
  fips  abbr  state_name pop_2022  long   lat order hole  piece group state_fips
  <chr> <chr> <chr>         <dbl> <dbl> <dbl> <int> <lgl> <fct> <fct> <chr>     
1 01    AL    Alabama     5074296 -88.5  31.9     1 FALSE 1     01.1  01        
2 01    AL    Alabama     5074296 -88.5  31.9     2 FALSE 1     01.1  01        
3 01    AL    Alabama     5074296 -88.5  31.9     3 FALSE 1     01.1  01        
4 01    AL    Alabama     5074296 -88.5  32.0     4 FALSE 1     01.1  01        
5 01    AL    Alabama     5074296 -88.5  32.0     5 FALSE 1     01.1  01        
6 01    AL    Alabama     5074296 -88.5  32.1     6 FALSE 1     01.1  01        
# i 1 more variable: state_abbv <chr>
\end{verbatim}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-27-1.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-28-1.pdf}}

Example 3

\begin{verbatim}
        lon      lat group     id
1 -83.88675 44.85686     1 alcona
2 -83.36536 44.86832     1 alcona
3 -83.36536 44.86832     1 alcona
4 -83.33098 44.83968     1 alcona
5 -83.30806 44.80530     1 alcona
6 -83.30233 44.77665     1 alcona
\end{verbatim}

Plot: in class

\section{rnaturalearth}\label{rnaturalearth}

rnaturalearth is an R package that provides ready-to-use maps of the
world, countries, and regions as sf (spatial) or data frames. It's a
super convenient way to get geographic data without downloading
shapefiles manually.

Example 1

\begin{verbatim}
Simple feature collection with 6 features and 121 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 79.65577 ymin: 7.272089 xmax: 81.41668 ymax: 9.829576
Geodetic CRS:  WGS 84
                         featurecla scalerank adm1_code diss_me iso_3166_2
1860 Admin-1 states provinces lakes         9  LKA-2454    2454      LK-53
1861 Admin-1 states provinces lakes         9  LKA-2458    2458      LK-45
1862 Admin-1 states provinces lakes         9  LKA-2459    2459      LK-41
1863 Admin-1 states provinces lakes         9  LKA-2460    2460      LK-42
1864 Admin-1 states provinces lakes         9  LKA-2457    2457      LK-43
1865 Admin-1 states provinces lakes         9  LKA-2462    2462      LK-62
     wikipedia iso_a2 adm0_sr          name            name_alt name_local
1860      <NA>     LK       1 Triku·πáƒÅmalaya         Trincomalee       <NA>
1861      <NA>     LK       1       Mulativ Mulativu|Mullaitivu       <NA>
1862      <NA>     LK       3      YƒÅpanaya              Jaffna       <NA>
1863      <NA>     LK       1   Kilin≈èchchi         Kilinochchi       <NA>
1864      <NA>     LK       3     MannƒÅrama              Mannar       <NA>
1865      <NA>     LK       1     Puttalama            Puttalam       <NA>
            type  type_en code_local code_hasc
1860 Distrikkaya District       <NA>     LK.TC
1861 Distrikkaya District       <NA>     LK.MP
1862 Distrikkaya District       <NA>     LK.JA
1863 Distrikkaya District       <NA>     LK.KL
1864 Distrikkaya District       <NA>     LK.MB
1865 Distrikkaya District       <NA>     LK.PX
                                  note hasc_maybe            region region_cod
1860                              <NA>       <NA> N√¶ÃÜgƒïnahira pa·∏∑ƒÅta       LK-5
1861                              <NA>       <NA>      Uturu pa·∏∑ƒÅta       LK-4
1862 Split into Jaffna and Kilinochchi       <NA>      Uturu pa·∏∑ƒÅta       LK-4
1863                              <NA>       <NA>      Uturu pa·∏∑ƒÅta       LK-4
1864                              <NA>       <NA>      Uturu pa·∏∑ƒÅta       LK-4
1865                              <NA>       <NA>    Vayamba pa·∏∑ƒÅta       LK-6
     provnum_ne gadm_level check_me datarank abbrev postal area_sqkm sameascity
1860      20013          1       10        6   <NA>     TC         0          7
1861      20005          1       10        6   <NA>     MP         0        -99
1862      20002          1       10        6   <NA>     JA         0        -99
1863      20001          1        0        6   <NA>     KL         0        -99
1864      20004          1       10        6   <NA>     MB         0        -99
1865      20006          1       10        6   <NA>     PX         0        -99
     labelrank name_len mapcolor9 mapcolor13 fips fips_alt   woe_id woe_label
1860         7       13         4          9 CE21     <NA> 23706507      <NA>
1861         9        7         4          9 CE27     <NA> 23706505      <NA>
1862         9        8         4          9 CE25     <NA> 23706489      <NA>
1863         9       11         4          9 <NA>     <NA> 23706490      <NA>
1864         9        9         4          9 CE26     <NA> 23706506      <NA>
1865         9        9         4          9 CE19     <NA> 23706502      <NA>
        woe_name latitude longitude sov_a3 adm0_a3 adm0_label     admin
1860 Trincomalee  8.56202   81.0848    LKA     LKA          2 Sri Lanka
1861  Mullaitivu  9.24043   80.5667    LKA     LKA          2 Sri Lanka
1862      Jaffna  9.50669   79.6933    LKA     LKA          2 Sri Lanka
1863 Kilinochchi  9.38429   80.3341    LKA     LKA          2 Sri Lanka
1864      Mannar  8.84371   80.0854    LKA     LKA          2 Sri Lanka
1865    Puttalam  7.94944   79.9111    LKA     LKA          2 Sri Lanka
      geonunit gu_a3   gn_id              gn_name   gns_id             gns_name
1860 Sri Lanka   LKA 1226258 Trincomalee District -2237626 Trincomalee District
1861 Sri Lanka   LKA 1234392 Mullaittivu District -2229490 Mullaittivu District
1862 Sri Lanka   LKA 1242831      Jaffna District -2221042      Jaffna District
1863 Sri Lanka   LKA 1240371 Kilinochchi District -2223504 Kilinochchi District
1864 Sri Lanka   LKA 1236148      Mannar District -2227730      Mannar District
1865 Sri Lanka   LKA 1229292    Puttalam District -2234591             Puttalam
     gn_level gn_region gn_a1_code region_sub sub_code gns_level gns_lang
1860        2      <NA> LK.1226258       <NA>     <NA>         2     <NA>
1861        2      <NA> LK.1234392       <NA>     <NA>         2     <NA>
1862        2      <NA> LK.1242831       <NA>     <NA>         2     <NA>
1863        2      <NA> LK.1240371       <NA>     <NA>         2     <NA>
1864        2      <NA> LK.1236148       <NA>     <NA>         2     <NA>
1865        2      <NA> LK.1229292       <NA>     <NA>         2     <NA>
     gns_adm1 gns_region min_label max_label min_zoom wikidataid
1860     <NA>       CE37       8.7        11      8.7   Q1493318
1861     <NA>       CE38       8.7        11      8.7   Q1587508
1862     <NA>       CE38       8.7        11      8.7   Q1520182
1863     <NA>       CE38       8.7        11      8.7   Q1584007
1864     <NA>       CE38       8.7        11      8.7    Q178003
1865     <NA>       CE32       8.7        11      8.7   Q1665318
               name_ar        name_bn     name_de     name_en     name_es
1860 ŸÖÿØŸäÿ±Ÿäÿ© ÿ™ÿ±ŸäŸÜŸÉŸàŸÖÿßŸÑŸä       ‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡ßÅ‡¶Æ‡¶æ‡¶≤‡¶Ø‡¶º Trincomalee Trincomalee Trincomalee
1861  ŸÖÿØŸäÿ±Ÿäÿ© ŸÖŸàŸÑÿßŸäÿ™ŸäŸÅŸà ‡¶Æ‡ßã‡¶≤‡¶æ‡¶á‡¶§‡¶ø‡¶¨‡ßã ‡¶ú‡ßá‡¶≤‡¶æ  Mullaitivu  Mullaitivu  Mullaitivu
1862      ŸÖÿØŸäÿ±Ÿäÿ© ÿ¨ÿßŸÅŸÜÿß       ‡¶á‡ßü‡¶æ‡¶™‡¶æ‡¶®‡¶æ‡¶Ø‡¶º      Jaffna      Jaffna      Jaffna
1863  ŸÖÿØŸäÿ±Ÿäÿ© ŸÉŸäŸÑŸäŸÜŸàÿ™ÿ¥Ÿä ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡ßã‡¶ï‡¶æ‡¶ö‡¶ø ‡¶ú‡ßá‡¶≤‡¶æ Kilinochchi Kilinochchi Kilinochchi
1864       ŸÖÿØŸäÿ±Ÿäÿ© ŸÖŸÜÿßÿ±     ‡¶Æ‡¶æ‡¶®‡¶æ‡¶∞ ‡¶ú‡ßá‡¶≤‡¶æ      Mannar      Mannar      Mannar
1865    ŸÖÿØŸäÿ±Ÿäÿ© ÿ®Ÿàÿ™ÿßŸÑÿßŸÖ   ‡¶™‡ßã‡¶§‡¶æ‡¶≤‡¶æ‡¶Æ ‡¶ú‡ßá‡¶≤‡¶æ    Puttalam    Puttalam    Puttalam
          name_fr        name_el         name_hi       name_hu       name_id
1860 Trinquemalay Œ§œÅŒπŒ∫ŒøœÖŒºŒ±ŒºŒ±ŒªŒ¨ŒπŒ± ‡§§‡•ç‡§∞‡§ø‡§Ç‡§ï‡•ã‡§®‡•ç‡§Æ‡§æ‡§≤‡•Ä ‡§ú‡§ø‡§≤‡§æ Triku·πáƒÅmalaya Triku·πáamalaya
1861   Mullaitivu   ŒúŒøœÖŒªŒ±œäœÑŒπŒ≤ŒøœçŒΩ      ‡§Æ‡•Å‡§≤‡•à‡§§‡§ø‡§µ‡•Å ‡§ú‡§ø‡§≤‡§æ    Mullaitivu    Mullaitivu
1862       Jaffna      ŒìŒπŒ±œÄŒ±ŒΩŒ¨ŒπŒ±       ‡§ú‡§´‡§º‡§®‡§æ ‡§ú‡§ø‡§≤‡§æ      YƒÅpanaya      Yapanaya
1863  Kilinochchi      ŒöŒπŒªŒπŒΩœåœÑœÉŒπ  ‡§ï‡§ø‡§≤‡§ø‡§®‡•ã‡§ö‡•ç‡§ö‡§ø ‡§ú‡§ø‡§≤‡§æ   Kilin≈èchchi   Kilinochchi
1864       Mannar          ŒúŒ±ŒΩŒ¨œÅ      ‡§Æ‡§®‡•ç‡§®‡§æ‡§∞ ‡§ú‡§ø‡§≤‡§æ     MannƒÅrama        Mannar
1865     Puttalam      Œ†ŒøœÖœÑœÑŒ±ŒªŒ¨Œº      ‡§™‡•Å‡§§‡•ç‡§§‡§≤‡§Æ ‡§ú‡§ø‡§≤‡§æ     Puttalama      Puttalam
         name_it                name_ja       name_ko     name_nl       name_pl
1860 Trincomalee       „Éà„É™„É≥„Ç≥„Éû„É™„ÉºÁúå Ìä∏ÎßÅÏΩîÎßêÎ¶¨ Íµ¨ Trincomalee Trikunamalaja
1861  Mullaitivu „É†„ÉÉ„É©„Ç§„ÉÉ„ÉÜ„Ç£„Éº„É¥„ÉºÁúå Î¨ºÎùºÏù¥Ìã∞Î∂Ä Íµ¨  Mullaitivu   Mullajttiwu
1862      Jaffna             „Ç∏„É£„Éï„ÉäÁúå     ÏûêÌîÑÎÇò Íµ¨      Jaffna        D≈ºafna
1863 Kilinochchi           „Ç≠„É™„Éé„ÉÉ„ÉÅÁúå ÌÇ¨Î¶¨ÎÖ∏ÏπòÏπò Íµ¨ Kilinochchi     Kilinoƒáƒái
1864      Mannar           „Éû„É≥„Éä„Éº„É´Áúå     ÎßåÎÇòÎ•¥ Íµ¨      Mannar        Mannar
1865    Puttalam           „Éó„ÉÉ„Çø„É©„É†Áúå     Ìë∏ÌÉàÎûå Íµ¨    Puttalam      Puttalam
         name_pt          name_ru     name_sv       name_tr          name_vi
1860 Trincomalee –¢—Ä–∏–Ω–∫–æ–º–∞–ª–∏ –æ–∫—Ä—É–≥ Trincomalee Triku·πáƒÅmalaya      Trincomalee
1861 Mullaittivu       –ú—É–ª–ª–∞–π—Ç–∏–≤—É  Mullaitivu    Mullaitivu  Qu·∫≠n Mullaitivu
1862      Jaffna     –æ–∫—Ä—É–≥ –î–∂–∞—Ñ–Ω–∞      Jaffna      YƒÅpanaya         YƒÅpanaya
1863 Kilinochchi        –ö–∏–ª–∏–Ω–æ—á—á–∏ Kilinochchi   Kilinochchi Qu·∫≠n Kilinochchi
1864      Mannar           –ú–∞–Ω–Ω–∞—Ä      Mannar        Mannar      Qu·∫≠n Mannar
1865    Puttalam         –ü—É—Ç—Ç–∞–ª–∞–º    Puttalam      Puttalam    Qu·∫≠n Puttalam
        name_zh      ne_id      name_he    name_uk        name_ur
1860 ‰∫≠ÂèØÈ¶¨ÈáåÂçÄ 1159311407 ◊ò◊®◊ô◊ß◊ï◊†◊î◊û◊ú◊ê◊ô◊î –¢—Ä—ñ–Ω–∫–æ–º–∞–ª—ñ ÿ™ÿ±€åŸÜ⁄©ŸàŸÖÿßŸÑ€å ÿ∂ŸÑÿπ
1861 Á©ÜËé±ËíÇÊ≠¶Âå∫ 1159311415        ◊û◊ï◊ú◊ò◊î –ú—É–ª–ª–∞–π—Ç—ñ–≤—É  ŸÖŸàŸÑÿß€åÿ™€åŸàŸà ÿ∂ŸÑÿπ
1862   Ë¥æÂ§´Á∫≥Âå∫ 1159311395     ◊ô◊ê◊§◊ê◊†◊ê◊ô◊î     –î–∂–∞—Ñ–Ω–∞       ÿ¨ŸÅŸÅŸÜÿßÿ∂ŸÑÿπ
1863 Âü∫Âà©ËØ∫Â•áÂå∫ 1159311417     ◊ß◊ô◊ú◊ô◊†◊¶'◊ô  –ö—ñ–ª—ñ–Ω–æ—á—á—ñ  ⁄©€åŸÑ€åŸÜŸà⁄Ü⁄Ü€å ÿ∂ŸÑÿπ
1864   È©¨Á∫≥Â∞îÂå∫ 1159311387     ◊î◊ê◊ô ◊û◊†◊°◊ú     –ú–∞–Ω–Ω–∞—Ä      ŸÖÿßŸÜÿßÿ± ÿ∂ŸÑÿπ
1865 ÊôÆÂ°îÂãíÂßÜÂå∫ 1159311421     ◊§◊ï◊ò◊ê◊ú◊ê◊û◊î   –ü—É—Ç—Ç–∞–ª–∞–º    ŸæŸàŸπÿßŸÑÿßŸÖ ÿ∂ŸÑÿπ
              name_fa   name_zht FCLASS_ISO FCLASS_US FCLASS_FR FCLASS_RU
1860 ŸÜÿßÿ≠€åŸá ÿ™ÿ±€åŸÜ⁄©ŸàŸÖÿßŸÑ€å ‰∫≠ÂèØÈ¶¨ÈáåÂçÄ       <NA>      <NA>      <NA>      <NA>
1861  ŸÜÿßÿ≠€åŸá ŸÖŸàŸÑÿß€åÿ™€åŸàŸà Á©ÜËêäËíÇÊ≠¶ÂçÄ       <NA>      <NA>      <NA>      <NA>
1862       ŸÜÿßÿ≠€åŸá ÿ¨ŸÅŸÜÿß   Ë≥àÂ§´Á¥çÂçÄ       <NA>      <NA>      <NA>      <NA>
1863   ŸÜÿßÿ≠€åŸá ⁄©€åŸÑ€åŸÜŸà⁄Ü€å Âü∫Âà©Ë´æÂ•áÂçÄ       <NA>      <NA>      <NA>      <NA>
1864       ŸÜÿßÿ≠€åŸá ŸÖŸÜÿßÿ±   È¶¨Á¥çÁàæÂçÄ       <NA>      <NA>      <NA>      <NA>
1865    ŸÜÿßÿ≠€åŸá ŸæŸàÿ™ÿßŸÑÿßŸÖ ÊôÆÂ°îÂãíÂßÜÂçÄ       <NA>      <NA>      <NA>      <NA>
     FCLASS_ES FCLASS_CN FCLASS_TW FCLASS_IN FCLASS_NP FCLASS_PK FCLASS_DE
1860      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1861      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1862      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1863      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1864      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1865      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
     FCLASS_GB FCLASS_BR FCLASS_IL FCLASS_PS FCLASS_SA FCLASS_EG FCLASS_MA
1860      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1861      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1862      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1863      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1864      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1865      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
     FCLASS_PT FCLASS_AR FCLASS_JP FCLASS_KO FCLASS_VN FCLASS_TR FCLASS_ID
1860      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1861      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1862      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1863      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1864      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1865      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
     FCLASS_PL FCLASS_GR FCLASS_IT FCLASS_NL FCLASS_SE FCLASS_BD FCLASS_UA
1860      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1861      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1862      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1863      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1864      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
1865      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>
     FCLASS_TLC                       geometry
1860       <NA> MULTIPOLYGON (((80.92292 8....
1861       <NA> MULTIPOLYGON (((80.62598 9....
1862       <NA> MULTIPOLYGON (((80.44174 9....
1863       <NA> MULTIPOLYGON (((80.29067 9....
1864       <NA> MULTIPOLYGON (((79.91278 8....
1865       <NA> MULTIPOLYGON (((79.82789 7....
\end{verbatim}

Example 2

\pandocbounded{\includegraphics[keepaspectratio]{06-chap6_files/figure-pdf/unnamed-chunk-31-1.pdf}}

\section{Practical}\label{practical}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Mark following locations on the map
\end{enumerate}

Help:

\begin{verbatim}
Simple feature collection with 9 features and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 105.5507 ymin: -43.63203 xmax: 167.9969 ymax: -9.229287
Geodetic CRS:  GDA94
# A tibble: 9 x 2
  NAME                                                                  geometry
* <chr>                                                       <MULTIPOLYGON [¬∞]>
1 New South Wales              (((150.7016 -35.12286, 150.6611 -35.11782, 150.6~
2 Victoria                     (((146.6196 -38.70196, 146.6721 -38.70259, 146.6~
3 Queensland                   (((148.8473 -20.3457, 148.8722 -20.37575, 148.85~
4 South Australia              (((137.3481 -34.48242, 137.3749 -34.46885, 137.3~
5 Western Australia            (((126.3868 -14.01168, 126.3625 -13.98264, 126.3~
6 Tasmania                     (((147.8397 -40.29844, 147.8902 -40.30258, 147.8~
7 Northern Territory           (((136.3669 -13.84237, 136.3339 -13.83922, 136.3~
8 Australian Capital Territory (((149.2317 -35.222, 149.2346 -35.24047, 149.271~
9 Other Territories            (((167.9333 -29.05421, 167.9188 -29.0344, 167.93~
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Projecting your data
\end{enumerate}

\bookmarksetup{startatroot}

\chapter*{Bibliography}\label{bibliography}
\addcontentsline{toc}{chapter}{Bibliography}

\markboth{Bibliography}{Bibliography}

\printbibliography[heading=none]





\end{document}
