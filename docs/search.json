[
  {
    "objectID": "08-chap8.html",
    "href": "08-chap8.html",
    "title": "\n8  Spatial Neighbours\n",
    "section": "",
    "text": "8.1 Package\nlibrary(spdep)\nlibrary(sf)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "08-chap8.html#data",
    "href": "08-chap8.html#data",
    "title": "\n8  Spatial Neighbours\n",
    "section": "\n8.2 Data",
    "text": "8.2 Data\n\ncolumbus &lt;- st_read(system.file(\"shapes/columbus.gpkg\", package=\"spData\")[1], quiet=TRUE)\ncolumbus\n\nSimple feature collection with 49 features and 20 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245\nProjected CRS: Undefined Cartesian SRS with unknown unit\nFirst 10 features:\n       AREA PERIMETER COLUMBUS_ COLUMBUS_I POLYID NEIG  HOVAL    INC     CRIME\n1  0.309441  2.440629         2          5      1    5 80.467 19.531 15.725980\n2  0.259329  2.236939         3          1      2    1 44.567 21.232 18.801754\n3  0.192468  2.187547         4          6      3    6 26.350 15.956 30.626781\n4  0.083841  1.427635         5          2      4    2 33.200  4.477 32.387760\n5  0.488888  2.997133         6          7      5    7 23.225 11.252 50.731510\n6  0.283079  2.335634         7          8      6    8 28.750 16.029 26.066658\n7  0.257084  2.554577         8          4      7    4 75.000  8.438  0.178269\n8  0.204954  2.139524         9          3      8    3 37.125 11.337 38.425858\n9  0.500755  3.169707        10         18      9   18 52.600 17.586 30.515917\n10 0.246689  2.087235        11         10     10   10 96.400 13.598 34.000835\n       OPEN    PLUMB DISCBD     X     Y NSA NSB EW CP THOUS NEIGNO\n1  2.850747 0.217155   5.03 38.80 44.07   1   1  1  0  1000   1005\n2  5.296720 0.320581   4.27 35.62 42.38   1   1  0  0  1000   1001\n3  4.534649 0.374404   3.89 39.82 41.18   1   1  1  0  1000   1006\n4  0.394427 1.186944   3.70 36.50 40.52   1   1  0  0  1000   1002\n5  0.405664 0.624596   2.83 40.01 38.00   1   1  1  0  1000   1007\n6  0.563075 0.254130   3.78 43.75 39.28   1   1  1  0  1000   1008\n7  0.000000 2.402402   2.74 33.36 38.41   1   1  0  0  1000   1004\n8  3.483478 2.739726   2.89 36.71 38.71   1   1  0  0  1000   1003\n9  0.527488 0.890736   3.17 43.44 35.92   1   1  1  0  1000   1018\n10 1.548348 0.557724   4.33 47.61 36.42   1   1  1  0  1000   1010\n                             geom\n1  POLYGON ((8.624129 14.23698...\n2  POLYGON ((8.25279 14.23694,...\n3  POLYGON ((8.653305 14.00809...\n4  POLYGON ((8.459499 13.82035...\n5  POLYGON ((8.685274 13.63952...\n6  POLYGON ((9.401384 13.5504,...\n7  POLYGON ((8.037741 13.60752...\n8  POLYGON ((8.247527 13.58651...\n9  POLYGON ((9.333297 13.27242...\n10 POLYGON ((10.08251 13.03377...",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "08-chap8.html#explore-data-structure",
    "href": "08-chap8.html#explore-data-structure",
    "title": "\n8  Spatial Neighbours\n",
    "section": "\n8.3 Explore data structure",
    "text": "8.3 Explore data structure\n\nst_crs(columbus)\n\nCoordinate Reference System:\n  User input: Undefined Cartesian SRS with unknown unit \n  wkt:\nENGCRS[\"Undefined Cartesian SRS with unknown unit\",\n    EDATUM[\"Unknown engineering datum\"],\n    CS[Cartesian,2],\n        AXIS[\"x\",unspecified,\n            ORDER[1],\n            LENGTHUNIT[\"unknown\",0]],\n        AXIS[\"y\",unspecified,\n            ORDER[2],\n            LENGTHUNIT[\"unknown\",0]]]\n\n\n\nsf::st_geometry(columbus)\n\nGeometry set for 49 features \nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245\nProjected CRS: Undefined Cartesian SRS with unknown unit\nFirst 5 geometries:",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "08-chap8.html#visualise-data",
    "href": "08-chap8.html#visualise-data",
    "title": "\n8  Spatial Neighbours\n",
    "section": "\n8.4 Visualise data",
    "text": "8.4 Visualise data\nst_geometry() is an sf function that extracts only the geometry from an sf object.\n\nst_geometry(columbus)\n\nGeometry set for 49 features \nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245\nProjected CRS: Undefined Cartesian SRS with unknown unit\nFirst 5 geometries:\n\n\n\nplot(st_geometry(columbus))",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "08-chap8.html#exercise",
    "href": "08-chap8.html#exercise",
    "title": "\n8  Spatial Neighbours\n",
    "section": "\n8.5 Exercise",
    "text": "8.5 Exercise\n\nYour turn: Use ggplot2 to draw the plot.\nWhat’s wrong here?\n\n\nlibrary(ggplot2)\nlibrary(sf)\n\nggplot(columbus) +\n  geom_sf() +\n  theme_minimal()\n\n\nlibrary(sf)\nlibrary(spdep)\n\ncolumbus &lt;- st_read(system.file(\"shapes/columbus.gpkg\", package=\"spData\")[1], quiet=TRUE)\n\nnb &lt;- poly2nb(as(columbus, \"Spatial\"))       # Queen neighbours\nnb\n\nNeighbour list object:\nNumber of regions: 49 \nNumber of nonzero links: 236 \nPercentage nonzero weights: 9.829238 \nAverage number of links: 4.816327 \n\n\n\ncoords &lt;- st_coordinates(st_centroid(columbus))\ncoords\n\n              X        Y\n [1,]  8.827218 14.36908\n [2,]  8.332658 14.03162\n [3,]  9.012265 13.81972\n [4,]  8.460801 13.71696\n [5,]  9.007982 13.29637\n [6,]  9.739926 13.47463\n [7,]  8.118750 13.29570\n [8,]  8.496488 13.40261\n [9,]  9.630793 12.94272\n[10,] 10.366383 13.00189\n[11,]  8.669735 12.98012\n[12,]  8.544996 12.95313\n[13,]  8.349223 12.99609\n[14,]  8.292702 12.86371\n[15,]  8.973462 12.74159\n[16,]  8.655866 12.62732\n[17,] 10.528621 12.64748\n[18,]  8.487918 12.54534\n[19,]  8.312368 12.66672\n[20,] 10.190582 12.25690\n[21,]  7.847424 12.08500\n[22,]  9.655244 12.46277\n[23,] 10.671381 12.29157\n[24,]  8.420744 12.31801\n[25,]  8.938752 12.38051\n[26,]  9.250921 12.41378\n[27,]  9.737004 12.14969\n[28,]  9.297976 11.97779\n[29,]  8.977862 11.99401\n[30,]  8.688719 11.93872\n[31,]  6.892482 11.91415\n[32,] 10.763784 11.84443\n[33,]  9.783876 11.92271\n[34,]  7.339431 11.62855\n[35,]  9.668249 11.69254\n[36,]  6.728838 11.63436\n[37,]  8.912363 11.63031\n[38,]  9.210527 11.65984\n[39,]  6.221943 11.40251\n[40,] 10.492493 11.50720\n[41,] 10.953587 11.47925\n[42,]  7.110051 11.29544\n[43,]  9.214330 11.43277\n[44,]  9.641904 11.39104\n[45,]  8.910340 11.14864\n[46,]  6.423385 11.21924\n[47,] 10.935302 11.01003\n[48,]  9.251957 11.18125\n[49,]  9.492144 11.01496\n\n\n\nplot(st_geometry(columbus), border = \"grey\") # polygons\n\n\n\n\n\n\n\n\nplot(st_geometry(columbus), border = \"grey\")\nplot(nb, coords, add = TRUE, col = \"red\")    # neighbour links\ntitle(\"Queen Contiguity Neighbours\")",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "08-chap8.html#exercise-compute-rook-neighbours",
    "href": "08-chap8.html#exercise-compute-rook-neighbours",
    "title": "\n8  Spatial Neighbours\n",
    "section": "\n8.6 Exercise: Compute Rook Neighbours",
    "text": "8.6 Exercise: Compute Rook Neighbours",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "08-chap8.html#compare-rook-vs-queen-neighbours",
    "href": "08-chap8.html#compare-rook-vs-queen-neighbours",
    "title": "\n8  Spatial Neighbours\n",
    "section": "\n8.7 Compare Rook vs Queen Neighbours",
    "text": "8.7 Compare Rook vs Queen Neighbours\n\nnb_queen &lt;- poly2nb(as(columbus, \"Spatial\"), queen = TRUE)\nnb_rook &lt;- poly2nb(as(columbus, \"Spatial\"), queen = FALSE)\nlengths(nb_queen)   # neighbours with queen\n\n [1]  2  3  4  4  8  2  4  6  8  4  5  6  4  6  6  8  3  4  3 10  3  6  3  7  8\n[26]  6  4  9  7  5  3  4  4  4  7  5  6  6  3  5  3  2  6  5  4  2  2  4  3\n\nlengths(nb_rook)    # neighbours with rook\n\n [1] 2 3 4 4 7 2 3 5 6 3 4 5 3 6 4 7 3 4 3 9 3 5 3 6 5 4 4 7 4 4 2 4 4 4 5 5 5 4\n[39] 2 4 3 2 5 4 4 2 2 4 3",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Spatial Neighbours</span>"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "DSA 554 3.0 Spatio-temporal Data Analysis",
    "section": "",
    "text": "Copyright notice\nProduced on 11 December 2025.\n© Thiyanga S. Talagala (2025).",
    "crumbs": [
      "Front matter"
    ]
  }
]